@use "~@fremtind/jkl-core/jkl";
@use "~@fremtind/jkl-core/mixins/_all" as mixins;
@use "~@fremtind/jkl-text-input/text-input" as text-input;

$granitt-rgb: 27, 25, 23;
$snohvit-rgb: 249, 249, 249;
$sand-rgb: 244, 242, 239;
$fjellgra-rgb: 68, 65, 65;
$advarsel-rgb: 253, 234, 185;

/* Se for variabler: https://www.algolia.com/doc/ui-libraries/autocomplete/api-reference/autocomplete-theme-classic/ */
:root {
    --aa-base-unit: 16;
    --aa-font-family: "Fremtind Grotesk", calibri, arial, sans-serif;
    --aa-detached-modal-max-height: initial;
    --aa-selected-color-alpha: 1;
}

@include jkl.helper-light-mode-variables {
    /* Bruk profilfarge for highlights i light mode (blir for dårlig kontrast i dark mode) */
    --aa-description-highlight-background-color-rgb: #{$advarsel-rgb};
    --aa-description-highlight-background-color-alpha: 1;
    --aa-text-color-rgb: #{$granitt-rgb};
    --aa-icon-color-rgb: #{$granitt-rgb};
    --aa-primary-color-rgb: #{$granitt-rgb};
    --aa-input-background-color-rgb: #{$snohvit-rgb};
    --aa-background-color-rgb: #{$snohvit-rgb};
    --aa-selected-color-rgb: #{$sand-rgb};
    --jkl-keyboard-hint-color: #{jkl.$color-stein};
    --jkl-keyboard-hint-border-color: #{jkl.$color-svaberg};
}

@include jkl.helper-dark-mode-variables {
    --aa-text-color-rgb: #{$snohvit-rgb};
    --aa-icon-color-rgb: #{$snohvit-rgb};
    --aa-primary-color-rgb: #{$snohvit-rgb};
    --aa-input-background-color-rgb: #{$granitt-rgb};
    --aa-background-color-rgb: #{$granitt-rgb};
    --aa-selected-color-rgb: #{$fjellgra-rgb};
    --jkl-keyboard-hint-color: #{jkl.$color-svaberg};
    --jkl-keyboard-hint-border-color: #{jkl.$color-stein};
}

.jkl-portal-search {
    width: jkl.rem(240px);

    &__footer {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        padding: jkl.$spacing-m jkl.$spacing-s jkl.$spacing-xs;
        padding-left: jkl.$spacing-s;
    }

    &__shortcuts {
        display: flex;
        gap: jkl.$spacing-xs;

        html[data-touchnavigation] & {
            display: none;
        }

        @include mixins.small-device {
            flex-direction: column;
        }
    }

    &__shortcut {
        display: inline;
        margin-right: jkl.$spacing-xs;
    }

    &__powered-by {
        color: var(--jkl-color);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: jkl.$spacing-2xs;
    }

    &__algolia-logo {
        height: var(--aa-font-size);
        margin-top: -2px;
    }
}

.aa-Form {
    border: none;
    background: none;
    -webkit-appearance: none;

    @include mixins.reset-outline;
    @include mixins.motion("standard");
    @include jkl.text-style("body/large-screen");

    border-radius: jkl.rem(3px);
    box-sizing: border-box;
    height: text-input.$text-input-height;
    padding: text-input.$text-input-padding;
    padding-right: 0;

    background-color: transparent;
    box-shadow: inset 0 0 0 jkl.rem(1px) var(--text-input-border-color), 0 0 0 jkl.rem(1px) transparent;

    transition-property: color, box-shadow, background-color;

    &:hover {
        box-shadow: inset 0 0 0 jkl.rem(1px) var(--text-input-focus-color),
            0 0 0 jkl.rem(1px) var(--text-input-focus-color);
        border-color: var(--text-input-focus-color);
    }

    &:focus,
    &:focus-within {
        background-color: var(--text-input-background-color);
        box-shadow: inset 0 0 0 jkl.rem(1px) var(--text-input-focus-color),
            0 0 0 jkl.rem(1px) var(--text-input-focus-color);
        border-color: var(--text-input-focus-color);
    }
}

.aa-InputWrapper {
    position: relative;
}

.aa-InputWrapperPrefix {
    order: 4; // vi har handlinger etter inputen
}

.aa-InputWrapperSuffix {
    display: none; // Unngå to handlinger på høyresiden
}

.aa-Panel {
    @include mixins.motion("standard", "lazy");

    z-index: jkl.$z-index--dropdown;
    position: fixed;
    transition-property: top;
    top: jkl.rem(72px) !important; // Biblioteket setter inline styles, men feiler på scrolling. Override.
    margin-top: jkl.rem(1px); // Gir plass til fokus-state på inputfeltet
    max-width: 50rem;

    @include mixins.small-device {
        top: jkl.rem(0) !important; // Biblioteket setter inline styles, men feiler på scrolling. Override.
    }

    .aa-Panel--scrollable {
        padding: jkl.$spacing-m jkl.$spacing-l;
        scrollbar-color: unset;
        scrollbar-width: unset;

        @include mixins.small-device {
            padding: jkl.$spacing-xs jkl.$spacing-xs;
        }
    }

    .aa-ItemWrapper {
        text-decoration: none;
        color: var(--jkl-color);
    }

    .aa-Item {
        padding: jkl.$spacing-s jkl.$spacing-m;
        border-bottom: 1px solid rgb(var(--aa-selected-color-rgb) 1);
    }

    .aa-Item[aria-selected="true"] {
        @include mixins.keyboard-navigation {
            outline: jkl.rem(2px) solid var(--jkl-color);
        }
    }

    .aa-ItemContentTitle {
        @include jkl.text-style("heading-5");
    }

    .aa-ItemContentDescription {
        @include jkl.text-style("small");
    }

    &--collapsed {
        top: jkl.rem(57px) !important; // Biblioteket setter inline styles, men feiler på scrolling. Override.
    }
}
