import{r as l,R as n}from"./index-siqcju79.js";import{B as w,P as T}from"./Button-Dng0c-UK.js";import{I as x}from"./index-BdKvcPYQ.js";import{M as P,a as N,b as q,c as D,d as I,f as R,g as _}from"./Modal-Cy5d9IMJ.js";import{u as L}from"./useModal-PTsSX8Wr.js";import{F as $}from"./Flex-DP-fj2ie.js";import{L as B}from"./Link-Dwdm3rDB.js";import"./_commonjsHelpers-DaWZu8wl.js";import"./clsx-B-dksMZM.js";import"./usePreviousValue-f0kyfTHz.js";import"./Loader-Dq-CBRAZ.js";import"./useDelayedRender-CQprwS1c.js";import"./index-yL1brwCS.js";import"./IconButton-B7cUPyFx.js";import"./CloseIcon-bvBUMA_V.js";import"./Icon-mINJCSxV.js";import"./index-Chjiymov.js";import"./useId-CahK3IZ3.js";import"./tokens-CvksrKef.js";import"./SlotComponent-CWN6EcE2.js";const A=e=>{if(typeof document>"u")return;const t=document.cookie.split(";").map(o=>o.trim().split("=")).find(o=>o[0]===e);if(t)return t},F=({adapter:e,name:t})=>{const o=A(t);if(o)return JSON.parse(o[1]);if(e)return e()},W=10368e3,H=({consent:e,maxAge:t=W,name:o,domain:a,path:r})=>{document.cookie=[`${o}=${JSON.stringify(e)}`,`max-age=${t}`,"SameSite=Lax",!!a&&`domain=${a}`,!!r&&`path=${r}`].filter(s=>s).join(";")},J=(e,t)=>{if(!t)return Object.values(e).some(r=>r);const o=new Map(Object.entries(t)),a=Object.entries(e);for(const[r,s]of a)if(s&&o.get(r)===null)return!0;return!1},y=e=>typeof e>"u"?null:e===!1||String(e).toLowerCase()==="false"?"denied":"accepted",j=(e,t)=>({functional:t.functional?y(e.functional):void 0,statistics:t.statistics?y(e.statistics):void 0,marketing:t.marketing?y(e.marketing):void 0}),K=({marketing:e,functional:t,statistics:o})=>({...e&&{marketing:e},...t&&{functional:t},...o&&{statistics:o}}),U="fremtind-cookie-consent",b=n.createContext(void 0),M=({children:e,cookieAdapter:t,marketing:o,functional:a,statistics:r,cookieName:s=U,cookieDomain:v,cookiePath:E})=>{const[f,d]=l.useState(()=>Date.now()),m=l.useMemo(()=>K({marketing:o,functional:a,statistics:r}),[o,a,r]),k=l.useMemo(()=>F({adapter:t,name:s})??{marketing:null,functional:null,statistics:null},[t,s,f]),[i,u]=l.useState(()=>J(m,k));return n.createElement(b.Provider,{value:{isOpen:i,setIsOpen:u,updateCurrentConsents:()=>d(Date.now()),requirement:m,currentConsent:k,cookieName:s,cookieDomain:v,cookiePath:E}},e)},G=()=>{const e=n.useContext(b);if(e===void 0)throw new Error("CookieConsent must be used within a CookieConsentProvider");return e},V=()=>{const e=l.useContext(b);if(e===void 0)throw new Error("useCookieConsent must be used within a CookieConsentProvider");const t=()=>{e.setIsOpen(!0)},o=e.currentConsent;return{openConsentModal:t,consents:o}};M.__docgenInfo={description:"",methods:[],displayName:"CookieConsentProvider",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},cookieAdapter:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Consent | undefined",signature:{arguments:[],return:{name:"union",raw:"Consent | undefined",elements:[{name:"signature",type:"object",raw:`{
    marketing?: ConsentState;
    functional?: ConsentState;
    statistics?: ConsentState;
}`,signature:{properties:[{key:"marketing",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"functional",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"statistics",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}}]}},{name:"undefined"}]}}},description:""},cookieName:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"fremtind-cookie-consent"',computed:!1}},cookieDomain:{required:!1,tsType:{name:"string"},description:""},cookiePath:{required:!1,tsType:{name:"string"},description:""}}};const X=({blocking:e,onAccept:t,aboutPage:o,...a})=>{const{currentConsent:r,cookieName:s,cookieDomain:v,cookiePath:E,requirement:f,isOpen:d,setIsOpen:m,updateCurrentConsents:k}=G(),[i,u]=L({id:`jkl-cookie-modal-${l.useId()}`,role:e?"alertdialog":"dialog",title:"Informasjonskapsler"});if(l.useEffect(()=>{d?i?.show():i?.hide()},[i,d]),l.useEffect(()=>{const c=()=>m(!1);return i?.on("hide",c),()=>{i?.off("hide",c)}},[i,m]),typeof document>"u")return null;if(typeof navigator<"u"&&!navigator.cookieEnabled)return t&&t({functional:"denied",marketing:"denied",statistics:"denied"}),null;const h=(c=j({functional:!0,statistics:!0,marketing:!0},f))=>{const p=Object.fromEntries(Object.entries(c).filter(([,S])=>typeof S<"u")),C={...r,...p};H({consent:C,name:s,domain:v,path:E}),k(),t?.(C),i?.hide()},O=c=>{c.preventDefault();const p=new FormData(c.currentTarget),C=j({functional:p.get("functional")==="true",statistics:p.get("statistics")==="true",marketing:p.get("marketing")==="true"},f);h(C)};return x.createPortal(n.createElement(P,{...u.container,...a,"data-cookie-consent-open":d},n.createElement(N,{...u.overlay}),n.createElement(q,{component:"form",...u.modal,onSubmit:O},n.createElement("form",null,n.createElement(D,null,n.createElement(I,{...u.title},"Kan vi bruke valgfrie informasjonskapsler?")),n.createElement(R,null,n.createElement($,{direction:"column",gap:24},n.createElement("p",null,"Hvis du svarer ja, bruker vi informasjons­­kapsler og lignende teknologi til statistikk, analyse, spørreundersøkelser og bruker­tester. Målet er å forstå hvordan du og andre bruker løsningen, slik at vi kan forbedre nettsidene og tjenestene våre."),n.createElement("p",null,"Merk at vi alltid lagrer tekniske informasjonskapsler for at nettsidene skal fungere."," ",n.createElement(B,{href:o},"Les mer om hvilke informasjonskapsler vi lagrer her"),"."))),n.createElement(_,null,n.createElement(w,{variant:"secondary","data-testid":"jkl-cookie-consent-godta-alle",type:"button",onClick:()=>h()},"Ja"),n.createElement(w,{variant:"secondary","data-testid":"jkl-cookie-consent-godta",type:"submit"},"Nei"))))),document.body)},ge={title:"Komponenter/CookieConsent",component:M,parameters:{layout:"centered"},tags:["autodocs"],args:{cookieName:"demo-consent-cookie",functional:!0,statistics:!0,marketing:!0}},z=({children:e})=>{const{openConsentModal:t}=V();return n.createElement("div",null,n.createElement(T,{onClick:()=>t()},"Åpne samtykker"),e)},g={args:{children:n.createElement(z,null,n.createElement(X,{aboutPage:"."}))}};g.parameters={...g.parameters,docs:{...g.parameters?.docs,source:{originalSource:`{
  args: {
    children: <Wrapper>
                <CookieConsentComponent aboutPage="." />
            </Wrapper>
  }
}`,...g.parameters?.docs?.source}}};const ve=["CookieConsent"];export{g as CookieConsent,ve as __namedExportsOrder,ge as default};
