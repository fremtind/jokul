import{r as c,R as n}from"./index-siqcju79.js";import{B as q,S as N,P as _}from"./Button-Bm5jRD6q.js";import{I}from"./index-BdKvcPYQ.js";import{M as D,a as P,b as R,c as $,d as A,f as B,g as F}from"./Modal-DkEi8KmZ.js";import{u as L}from"./useModal-PTsSX8Wr.js";import{C as W}from"./Checkbox-CwfoYjrc.js";import"./_commonjsHelpers-DaWZu8wl.js";import"./clsx-B-dksMZM.js";import"./usePreviousValue-f0kyfTHz.js";import"./Loader-Dq-CBRAZ.js";import"./useDelayedRender-CQprwS1c.js";import"./index-yL1brwCS.js";import"./IconButton-BsqD9nTf.js";import"./CloseIcon-bvBUMA_V.js";import"./Icon-mINJCSxV.js";import"./index-Chjiymov.js";import"./useId-CahK3IZ3.js";const V=e=>{if(typeof document>"u")return;const t=document.cookie.split(";").map(o=>o.trim().split("=")).find(o=>o[0]===e);if(t)return t},G=({adapter:e,name:t})=>{const o=V(t);if(o)return JSON.parse(o[1]);if(e)return e()},H=10368e3,J=({consent:e,maxAge:t=H,name:o,domain:a,path:r})=>{document.cookie=[`${o}=${JSON.stringify(e)}`,`max-age=${t}`,"SameSite=Lax",!!a&&`domain=${a}`,!!r&&`path=${r}`].filter(i=>i).join(";")},K=(e,t)=>{if(!t)return Object.values(e).some(r=>r);const o=new Map(Object.entries(t)),a=Object.entries(e);for(const[r,i]of a)if(i&&o.get(r)===null)return!0;return!1},j=e=>typeof e>"u"?null:e===!1||String(e).toLowerCase()==="false"?"denied":"accepted",S=(e,t)=>({functional:t.functional?j(e.functional):void 0,statistics:t.statistics?j(e.statistics):void 0,marketing:t.marketing?j(e.marketing):void 0}),U=({marketing:e,functional:t,statistics:o})=>({...e&&{marketing:e},...t&&{functional:t},...o&&{statistics:o}}),X="fremtind-cookie-consent",w=n.createContext(void 0),M=({children:e,cookieAdapter:t,marketing:o,functional:a,statistics:r,cookieName:i=X,cookieDomain:b,cookiePath:l})=>{const[m,g]=c.useState(()=>Date.now()),C=c.useMemo(()=>U({marketing:o,functional:a,statistics:r}),[o,a,r]),u=c.useMemo(()=>G({adapter:t,name:i})??{marketing:null,functional:null,statistics:null},[t,i,m]),[p,k]=c.useState(()=>K(C,u));return n.createElement(w.Provider,{value:{isOpen:p,setIsOpen:k,updateCurrentConsents:()=>g(Date.now()),requirement:C,currentConsent:u,cookieName:i,cookieDomain:b,cookiePath:l}},e)},z=()=>{const e=n.useContext(w);if(e===void 0)throw new Error("CookieConsent must be used within a CookieConsentProvider");return e},Q=()=>{const e=c.useContext(w);if(e===void 0)throw new Error("useCookieConsent must be used within a CookieConsentProvider");const t=()=>{e.setIsOpen(!0)},o=e.currentConsent;return{openConsentModal:t,consents:o}};M.__docgenInfo={description:"",methods:[],displayName:"CookieConsentProvider",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},cookieAdapter:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Consent | undefined",signature:{arguments:[],return:{name:"union",raw:"Consent | undefined",elements:[{name:"signature",type:"object",raw:`{
    marketing?: ConsentState;
    functional?: ConsentState;
    statistics?: ConsentState;
}`,signature:{properties:[{key:"marketing",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"functional",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"statistics",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}}]}},{name:"undefined"}]}}},description:""},cookieName:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"fremtind-cookie-consent"',computed:!1}},cookieDomain:{required:!1,tsType:{name:"string"},description:""},cookiePath:{required:!1,tsType:{name:"string"},description:""}}};const E=({defaultChecked:e,name:t,label:o,children:a,...r})=>n.createElement(n.Fragment,null,n.createElement(W,{...r,className:"jkl-cookie-consent-modal__checkbox",value:"true",name:t,defaultChecked:e},o),n.createElement("p",{className:"jkl-cookie-consent-modal__info-text"},a));E.__docgenInfo={description:"",methods:[],displayName:"RequirementCheckbox",props:{defaultChecked:{required:!0,tsType:{name:"boolean"},description:""},name:{required:!0,tsType:{name:"union",raw:'"functional" | "marketing" | "statistics"',elements:[{name:"literal",value:'"functional"'},{name:"literal",value:'"marketing"'},{name:"literal",value:'"statistics"'}]},description:""},label:{required:!0,tsType:{name:"string"},description:""}},composes:["Omit"]};const Y=({blocking:e,onAccept:t,...o})=>{const{currentConsent:a,cookieName:r,cookieDomain:i,cookiePath:b,requirement:l,isOpen:m,setIsOpen:g,updateCurrentConsents:C}=z(),u=Array.from(Object.keys(l)),[p,k]=c.useState(a),[d,v]=L({id:`jkl-cookie-modal-${c.useId()}`,role:e?"alertdialog":"dialog",title:"Informasjonskapsler"});if(c.useEffect(()=>{m?d?.show():d?.hide()},[d,m]),c.useEffect(()=>{const s=()=>g(!1);return d?.on("hide",s),()=>{d?.off("hide",s)}},[d,g]),typeof document>"u")return null;if(typeof navigator<"u"&&!navigator.cookieEnabled)return t&&t({functional:"denied",marketing:"denied",statistics:"denied"}),null;const O=(s=S({functional:!0,statistics:!0,marketing:!0},l))=>{const f=Object.fromEntries(Object.entries(s).filter(([,x])=>typeof x<"u")),h={...a,...f};J({consent:h,name:r,domain:i,path:b}),C(),t?.(h),d?.hide()},T=s=>{s.preventDefault();const f=new FormData(s.currentTarget),h=S({functional:f.get("functional")==="true",statistics:f.get("statistics")==="true",marketing:f.get("marketing")==="true"},l);O(h)};return I.createPortal(n.createElement(D,{...v.container,...o,"data-cookie-consent-open":m},n.createElement(P,{...v.overlay}),n.createElement(R,{component:"form",...v.modal,onSubmit:T},n.createElement("form",null,n.createElement($,null,n.createElement(A,{...v.title},"Velg informasjonskapsler")),n.createElement(B,null,l.functional&&n.createElement(E,{name:"functional",label:"Funksjonelle",defaultChecked:a.functional==="accepted",key:`functional-${a.functional}`,onChange:s=>{k({...p,functional:s.target.checked?"accepted":"denied"})}},"Funksjonelle informasjonskapsler lagrer opplysninger om din bruk av nettsidene og hvilke innstillinger du har gjort, slik at du kan få funksjonalitet tilpasset deg."),l.statistics&&n.createElement(E,{name:"statistics",label:"Statistikk",defaultChecked:a.statistics==="accepted",key:`statistics-${a.statistics}`,onChange:s=>{k({...p,statistics:s.target.checked?"accepted":"denied"})}},"Informasjonskapslene lagrer statistikk som hjelper oss med å forstå hvordan nettsidene blir brukt, slik at vi kan gjøre dem bedre og enklere å bruke."),l.marketing&&n.createElement(E,{name:"marketing",label:"Personlig markedsføring",defaultChecked:a.marketing==="accepted",key:`marketing-${a.marketing}`,onChange:s=>{k({...p,marketing:s.target.checked?"accepted":"denied"})}},"Dette gjør at vi kan gi deg mer relevant og tilpasset markedsføring, også gjennom våre samarbeidspartnere, på for eksempel nettsider, annonser og i sosiale medier."),n.createElement("br",null),n.createElement("p",null,"Vi lagrer alltid tekniske informasjonskapsler for at nettsidene skal fungere.")),n.createElement(F,null,n.createElement(q,{variant:u.length>=1?"secondary":"primary","data-testid":"jkl-cookie-consent-godta-alle",type:"button",onClick:()=>O()},"Godta",u.length>1&&" alle"),u.length>=1&&n.createElement(N,{"data-testid":"jkl-cookie-consent-godta",type:"submit"},"Avslå valgfrie"))))),document.body)},Ce={title:"Komponenter/CookieConsent",component:M,parameters:{layout:"centered"},tags:["autodocs"],argTypes:{}},Z=({children:e})=>{const{openConsentModal:t}=Q();return n.createElement("div",null,n.createElement(_,{onClick:()=>t()},"Åpne samtykker"),e)},y={args:{children:n.createElement(Z,null,n.createElement(Y,null)),cookieName:"demo-consent-cookie",functional:!0,statistics:!0,marketing:!0}};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  args: {
    children: <Wrapper>
                <CookieConsentComponent />
            </Wrapper>,
    cookieName: "demo-consent-cookie",
    functional: true,
    statistics: true,
    marketing: true
  }
}`,...y.parameters?.docs?.source}}};const ve=["CookieConsent"];export{y as CookieConsent,ve as __namedExportsOrder,Ce as default};
