import{r as s,j as r,R as x}from"./iframe-Cku2L_FL.js";import{n as I,p as W,q as G,r as J,d as Q,j as X,f as Y,e as Z,h as ee,i as ne,t as te,v as se,u as re,a as oe,w as ae,F as ie,b as le,k as ue,o as de,l as ce,s as me}from"./floating-ui.react-C3DR0P0B.js";import{c as pe}from"./clsx-B-dksMZM.js";import{g as fe}from"./getThemeAndSize-CIzqY74s.js";import{u as ge}from"./useBrowserPreferences-C6MCaVJA.js";import{S as C}from"./SlotComponent-J2aEADod.js";const ke=(n,e,l)=>{const[g,k]=s.useState(!1),[c,m]=s.useState(!1);return s.useEffect(()=>{if(!n)return;function o(){m(!1)}function a(u){e&&u.nodeId!==e&&u.parentId===l&&m(!1)}return n.events.on("click",o),n.events.on("menuopen",a),()=>{n.events.off("click",o),n.events.off("menuopen",a)}},[n,e,l]),s.useEffect(()=>{c&&n&&e&&n.events.emit("menuopen",{parentId:l,nodeId:e})},[n,c,e,l]),s.useEffect(()=>{function o({pointerType:u}){u!=="touch"&&k(!0)}function a(){k(!1)}return window.addEventListener("pointermove",o,{once:!0,capture:!0}),window.addEventListener("keydown",a,!0),()=>{window.removeEventListener("pointermove",o,{capture:!0}),window.removeEventListener("keydown",a,!0)}},[g]),{allowHover:g,isOpen:c,setIsOpen:m}};function O(n,e=0){switch(n){case"top":return`0 ${e}px`;case"left":return`${e}px 0`;case"bottom":return`0 ${-e}px`;case"right":return`${-e}px 0`;default:return`0 ${e}px`}}const b=s.forwardRef((n,e)=>{const{children:l,className:g,initialPlacement:k,openOnHover:c=!1,keepOpenOnClickOutside:m=!1,triggerElement:o,isOpen:a,onToggle:u,...S}=n,E=`"jkl-menu"${s.useId()}`,{prefersReducedMotion:R}=ge(),y=G(),v=J(),T=I(),p=T!=null,M=s.useRef([]),[N,P]=s.useState(null),{allowHover:j,isOpen:A,setIsOpen:F}=ke(y,v,T),f=a!==void 0?a:A;s.useEffect(()=>u?.(f),[f,u]);const{refs:w,placement:D,context:d,floatingStyles:H}=Q({nodeId:v,open:f,onOpenChange:F,placement:k||(p?"right-start":"bottom-start"),middleware:[de(2),ce({fallbackAxisSideDirection:"end",crossAxis:!1}),me({padding:8})],whileElementsMounted:ue}),{getReferenceProps:L,getFloatingProps:$,getItemProps:K}=X([Y(d,{enabled:c&&j,delay:{open:75},handleClose:se({requireIntent:!0,blockPointerEvents:!0})}),Z(d,{event:"mousedown"}),ee(d,{outsidePress:!m}),ne(d,{role:"menu"}),te(d,{listRef:M,activeIndex:N,nested:p,onNavigate:P})]),z=re([w.setReference,e]),{theme:B,size:V}=fe(w.reference.current),{isMounted:_,styles:U}=oe(d,{duration:{open:R?0:250,close:R?0:150},initial:({side:t})=>({opacity:0,translate:O(t,5)}),open:({side:t})=>({opacity:1,translate:O(t,0)}),close:({side:t})=>({opacity:0,translate:O(t,5)})});return r.jsxs(ae,{id:v,children:[x.isValidElement(o)&&r.jsx(C,{...L({...S,ref:z,role:p?"menuitem":void 0,"aria-controls":E,onClick(t){t.stopPropagation()}}),children:o}),_&&r.jsx(ie,{children:r.jsx(le,{context:d,modal:!1,initialFocus:p?-1:0,returnFocus:!p,children:r.jsx("div",{className:pe("jkl jkl-menu",g),"data-theme":B,"data-size":V,role:"menu","data-placement":D,"aria-live":"assertive","aria-hidden":!f,ref:w.setFloating,...$({id:E,style:{...H,...U}}),children:x.Children.map(l,(t,h)=>x.isValidElement(t)?r.jsx(C,{...K({...t.props,tabIndex:N===h?0:-1,role:"menuitem",ref(i){M.current[h]=i},onClick(i){i.defaultPrevented||y?.events.emit("click")},onKeyDown(i){t.props.onKeyDown?.(i),!i.defaultPrevented&&(y?.events.emit("keydown"),i.currentTarget.role==="menuitemcheckbox"&&i.key==="Enter"&&F(!1))},onMouseEnter(){j&&f&&P(h)}}),children:t}):t)})})})]})});b.displayName="MenuComponent";const q=s.forwardRef((n,e)=>I()===null?r.jsx(W,{children:r.jsx(b,{ref:e,...n})}):r.jsx(b,{ref:e,...n}));q.displayName="Menu";q.__docgenInfo={description:"",methods:[],displayName:"Menu",props:{"data-testautoid":{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},initialPlacement:{required:!1,tsType:{name:"Placement"},description:`Initiell plassering av menyen. Dersom det ikke er plass på skjermen der du
angir at den skal åpnes vil den slyttes automatisk.
@default "bottom-start" på toppnivå, "right-start" for undermenyer`},openOnHover:{required:!1,tsType:{name:"boolean"},description:`Angir om menyen skal åpnes ved hover (uten å måtte klikke)
@default false`},keepOpenOnClickOutside:{required:!1,tsType:{name:"boolean"},description:`Angir om menyen skal holdes åpen når man klikker utenfor menyen
@default false`},triggerElement:{required:!0,tsType:{name:"ReactNode"},description:'Elementet som fungerer som trigger for menyen. Dersom elementet ikke er en `<button type="button">`\neller en `forwardRef<HTMLButtonElement>` vil det bli lagt inne i en knapp\nmed forhåndsdefinert stil. For å komme raskt i gang kan du bruke komponenten\n`MenuTriggerButton` fra denne pakken.'},isOpen:{required:!1,tsType:{name:"boolean"},description:`Kan brukes til å styre utenfra om menyen skal være åpen eller ikke.
@default false`},onToggle:{required:!1,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:"Callback som kalles når menyen åpnes eller lukkes."}},composes:["Omit"]};export{q as M};
