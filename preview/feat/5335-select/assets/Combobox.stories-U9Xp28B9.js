import{j as n}from"./jsx-runtime-DqZpzl9T.js";import{c as F}from"./clsx-B-dksMZM.js";import{r as a}from"./index-siqcju79.js";import{u as ce}from"./useAnimatedHeight-BAxzwhOL.js";import{u as de}from"./useId-CahK3IZ3.js";import{u as me}from"./useListNavigation-Bf1PKTdz.js";import{C as pe}from"./Chip-Du_KB-wD.js";import{I as be}from"./IconButton-CwYjR4Na.js";import{C as fe}from"./CheckIcon-BRyROgH7.js";import{A as ve}from"./ArrowVerticalAnimated-Dz5LN4Sz.js";import{I as ge}from"./InputGroup-fvuXdu4J.js";import{T as ye,a as ke,b as he}from"./TooltipTrigger-CEWL96k-.js";/* empty css               */import"./_commonjsHelpers-DaWZu8wl.js";import"./tokens-d2GYn7oW.js";import"./useBrowserPreferences-B9LcbCiO.js";import"./usePreviousValue-f0kyfTHz.js";import"./CloseIcon-CGR_BR3u.js";import"./Icon-DnRkF4CO.js";import"./ArrowDownIcon-BlnkIUxx.js";import"./Label-Ct8Bs2e9.js";import"./SupportLabel-BNvn73Dv.js";import"./ErrorIcon-4c1VmZaU.js";import"./WarningIcon-Bm98p7gS.js";import"./getThemeAndDensity-CIeob-5A.js";import"./index-BdKvcPYQ.js";import"./index-yL1brwCS.js";function xe(c){return typeof c=="string"?{value:c,label:c}:c}const E=({id:c,placeholder:M,items:f,onChange:h,onFocus:T,onBlur:A,value:q,label:B,noMatchingOption:K,labelProps:H,helpLabel:G,errorLabel:I,width:J,density:U,name:u,className:X,invalid:z,description:Q,hasTagHover:W})=>{const i=de(c||"jkl-combobox",{generateSuffix:!c}),N=`${i}_label`,Y=`${i}_button`,Z=`${i}_search-input`,[r,v]=a.useState(q||[]),[l,d]=a.useState(!1),[b,g]=a.useState(""),[ee,te]=a.useState(!1),[R,L]=a.useState(!1),o=a.useRef(null),x=a.useRef(null),j=a.useRef(!1);a.useEffect(()=>{g(""),l&&o.current&&o.current.focus()},[l]),a.useEffect(()=>{v(e=>q||e)},[q]);const P=e=>r?r.some(t=>t.value===e.value):!1,w=a.useCallback(e=>r.filter(t=>t.value!==e),[r]),C=a.useCallback((e,t)=>{const s=w(t);v(s),h({type:"change",target:{name:u,value:t,selectedOptions:s}}),e.stopPropagation(),s.length===0&&L(!1)},[w,h,u]),ae=a.useCallback(e=>{let t;if(r.some(s=>s.value===e))t=w(e);else{const s=f.find(k=>k.value===e);t=[...r,s]}o.current?.focus(),v(t),h({type:"change",target:{name:u,value:e,selectedOptions:t}})},[r,h,u,w,f]),re=e=>{o.current?.focus(),d(!0),g(e.target.value)},S=a.useMemo(()=>{if(!b)return f;const e=f.filter(t=>t.label.toLowerCase().indexOf(b.toLowerCase())>=0);return te(e.length===0),e},[b,f]),[ne,se]=a.useState(S[0]?.value?`${i}-${S[0]?.value}`:void 0),oe=!l;a.useEffect(()=>{const e=t=>{t.key==="Escape"&&l&&d(!1)};return typeof window<"u"&&window.addEventListener("keydown",e),()=>{typeof window<"u"&&l&&window.removeEventListener("keydown",e)}},[l]);const O=a.useCallback(e=>{e?o.current&&o.current.focus():j.current&&x.current&&x.current.focus()},[]),y=a.useCallback(()=>{j.current||(T&&T({type:"change",target:{name:u,value:r?.[0].value||"",selectedOptions:r}}),j.current=!0,d(!0))},[T,r,u]),[m]=ce(l,{onFirstVisible:O,onTransitionEnd:O});me({ref:m});const V=a.useRef(null),p=a.useCallback(e=>{V.current?.contains(e.relatedTarget)||(g(""),A&&(A({type:"blur",target:{name:u,value:r?.[0]?.value||"",selectedOptions:r}}),x.current?.dispatchEvent(new Event("focusout",{bubbles:!0}))),j.current=!1,d(!1))},[A,u,r]),le=a.useCallback(e=>{e.target.focus({preventScroll:!0})},[]),ie=a.useCallback(e=>{if(e.key==="ArrowDown"){e.preventDefault(),e.stopPropagation();const t=m.current;t&&t.querySelector('[role="option"]')?.focus()}else e.key==="Escape"&&(e.preventDefault(),e.stopPropagation(),d(!1));if(e.metaKey&&e.key==="a"||e.ctrlKey&&e.key==="a"){e.preventDefault(),e.stopPropagation();const t=r.map(s=>({...s,isMarked:!0}));L(!0),v(t)}else if(e.key==="Backspace")if(e.stopPropagation(),L(!1),r.some(s=>s.isMarked)){const s=r.filter(k=>!k.isMarked);v(s),g("")}else r.length>0&&b===""&&C(e,r[r.length-1].value)},[r,b,m,C]),ue=a.useCallback(e=>{if(e.key==="Tab")o.current&&(e.preventDefault(),e.stopPropagation(),e.shiftKey||d(!1),o.current.focus());else if(e.key==="ArrowUp"&&m.current&&o.current){const t=m.current.querySelector('[role="option"]:not([hidden])');e.currentTarget.id===t?.id&&o.current&&o.current.focus()}},[m]),D=r.length>=1,$=a.useCallback(e=>n.jsx(pe,{"data-testid":"jkl-chip","aria-label":`Fjern ${e.tagLabel}`,className:`jkl-combobox__selected-option ${R&&"jkl-combobox__selected-option--marked"}`,variant:"input",onClick:t=>{o.current&&o.current.focus(),C(t,e.value)},onBlur:p,children:e.tagLabel?e.tagLabel:e.label},e.value),[p,C,R]);return n.jsx(ge,{label:B,id:Z,ref:V,"data-testid":"jkl-combobox",className:F("jkl-combobox",X,{"jkl-combobox--invalid":!!I||z,"jkl-combobox--menu-open":l,"jkl-combobox--menu-closed":!l&&D}),labelProps:{id:N,...H},helpLabel:G,errorLabel:I,density:U,description:Q,render:e=>n.jsxs("div",{className:F("jkl-combobox__wrapper",{"jkl-combobox__wrapper--active-value":D}),style:{width:J},tabIndex:-1,onFocus:y,onBlur:p,children:[n.jsxs("div",{className:"jkl-combobox__chips","data-testid":"jkl-combobox__chips",children:[r.map(xe).map(t=>W?n.jsxs(ye,{children:[n.jsx(ke,{children:$(t)}),n.jsx(he,{children:t.label})]},t.value):$(t)),n.jsx("input",{...e,className:"jkl-combobox__search-input",onChange:re,"data-testid":"jkl-combobox__search-input",onFocus:y,onBlur:p,onKeyDown:ie,value:b,ref:o,"aria-controls":i,role:"combobox","aria-autocomplete":"list","aria-expanded":l,placeholder:r.length>0?"":M,autoComplete:"off"})]}),n.jsxs("div",{className:"jkl-combobox__menu",role:"listbox",ref:m,id:i,"aria-labelledby":N,"aria-multiselectable":"true","aria-activedescendant":ne,onFocus:y,onBlur:p,tabIndex:-1,children:[S.map((t,s)=>n.jsxs("button",{type:"button",id:`${i}__${t.value}`,"aria-selected":P(t),role:"option",value:t.value,onBlur:p,className:`jkl-combobox__option ${P(t)&&"jkl-combobox__option--selected"}`,"data-testid":"jkl-combobox__option","data-testautoid":`jkl-combobox__option-${s}`,onFocus:y,onKeyDown:ue,onClick:k=>{se(`${i}__${t.value}`),k.stopPropagation(),ae(t.value),g("")},onMouseOver:le,children:[t.description?n.jsxs("span",{children:[t.label,n.jsx("span",{className:"jkl-combobox__option-description",children:t.description})]}):t.label,P(t)?n.jsxs("span",{children:[n.jsx(fe,{})," "]}):null]},`${i}-${t.value}`)),ee&&n.jsx("div",{className:"jkl-combobox__no-option",children:K})]}),n.jsx("div",{className:"jkl-combobox__actions",children:n.jsx(be,{id:Y,onFocus:y,onBlur:p,className:"jkl-combobox__button","data-testid":"jkl-combobox__button","aria-label":"Ã…pne meny","aria-expanded":l,"aria-controls":i,onClick:()=>d(t=>!t),onMouseDown:t=>{t.preventDefault(),x.current?.focus()},children:n.jsx(ve,{pointingDown:oe})})})]})})};E.displayName="Combobox";E.__docgenInfo={description:"",methods:[],displayName:"Combobox",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},"data-testautoid":{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},"data-testid":{required:!1,tsType:{name:"string"},description:""},density:{required:!1,tsType:{name:"union",raw:'"comfortable" | "compact"',elements:[{name:"literal",value:'"comfortable"'},{name:"literal",value:'"compact"'}]},description:""},errorLabel:{required:!1,tsType:{name:"string"},description:""},helpLabel:{required:!1,tsType:{name:"string"},description:""},inline:{required:!1,tsType:{name:"boolean"},description:""},label:{required:!0,tsType:{name:"string"},description:""},labelProps:{required:!1,tsType:{name:"Omit",elements:[{name:"LabelProps"},{name:"union",raw:'"children" | "density" | "htmlFor" | "standAlone"',elements:[{name:"literal",value:'"children"'},{name:"literal",value:'"density"'},{name:"literal",value:'"htmlFor"'},{name:"literal",value:'"standAlone"'}]}],raw:`Omit<
    LabelProps,
    "children" | "density" | "htmlFor" | "standAlone"
>`},description:""},supportLabelProps:{required:!1,tsType:{name:"Omit",elements:[{name:"SupportLabelProps"},{name:"union",raw:'"id" | "errorLabel" | "helpLabel" | "density"',elements:[{name:"literal",value:'"id"'},{name:"literal",value:'"errorLabel"'},{name:"literal",value:'"helpLabel"'},{name:"literal",value:'"density"'}]}],raw:`Omit<
    SupportLabelProps,
    "id" | "errorLabel" | "helpLabel" | "density"
>`},description:""},description:{required:!1,tsType:{name:"string"},description:""},tooltip:{required:!1,tsType:{name:"ReactNode"},description:""},style:{required:!1,tsType:{name:"CSSProperties"},description:""},render:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: InputProps) => JSX.Element",signature:{arguments:[{type:{name:"InputProps"},name:"props"}],return:{name:"JSX.Element"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    value: string;
    label: string;
    description?: string;
}`,signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"Array<ValuePair>"},description:""},noMatchingOption:{required:!1,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    value: string;
    label: string;
    description?: string;
}`,signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"Array<ValuePair>"},description:""},width:{required:!1,tsType:{name:"string"},description:""},invalid:{required:!1,tsType:{name:"boolean"},description:""},hasTagHover:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""}}};const je=[{value:"a080",label:"A080 - Rotavirusenteritt",tagLabel:"A080"},{value:"a081",label:"A081 - Akutt gastroenteritt som skyldes norovirus",tagLabel:"A081"},{value:"a082",label:"A082 - Adenovirusenteritt",tagLabel:"A082"},{value:"a083",label:"A083 - Annen virusenteritt",tagLabel:"A083"},{value:"a084",label:"A084 - Uspesifisert virusinfeksjon i mage-tarmkanalen",tagLabel:"A084"},{value:"a085",label:"A085 - Annen spesifisert mage-tarminfeksjon",tagLabel:"A085"},{value:"a090",label:"A090 - Annen eller uspesifisert gastroenteritt eller kolitt av infeksiÃ¸s Ã¥rsak",tagLabel:"A090"},{value:"a099",label:"A099 - Gastroenteritt eller kolitt av uspesifisert Ã¥rsak",tagLabel:"A099"},{value:"a150",label:"A150 - Lungetuberkulose bekreftet ved mikroskopi av sputum med eller uten kultur",tagLabel:"A150"}],Qe={title:"Komponenter/Combobox",component:E,parameters:{layout:"centered"},argTypes:{className:{table:{disable:!0}},id:{table:{disable:!0}},"data-testautoid":{table:{disable:!0}},density:{table:{disable:!0}},onBlur:{table:{disable:!0}},onFocus:{table:{disable:!0}},onChange:{table:{disable:!0}},children:{table:{disable:!0}},"data-testid":{table:{disable:!0}},style:{table:{disable:!0}},supportLabelProps:{table:{disable:!0}},render:{table:{disable:!0}},tooltip:{table:{disable:!0}}},args:{placeholder:"Velg",inline:!1,invalid:!1,hasTagHover:!1,labelProps:{srOnly:!1,variant:"small"},width:"20ch",description:"Du kan velge flere, dersom flere passer",onChange:()=>""},tags:["autodocs","forms"]},_={name:"Combobox",args:{items:je,name:"disease",label:"Velg sykdommer"}};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`{
  name: "Combobox",
  args: {
    items,
    name: "disease",
    label: "Velg sykdommer"
  }
}`,..._.parameters?.docs?.source}}};const We=["ComboboxStory"];export{_ as ComboboxStory,We as __namedExportsOrder,Qe as default};
