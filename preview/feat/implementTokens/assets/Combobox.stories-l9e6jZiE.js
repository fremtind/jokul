import{c as M}from"./clsx-B-dksMZM.js";import{r as a,R as r}from"./index-siqcju79.js";import{u as ce}from"./useAnimatedHeight-B4AinHXK.js";import{u as me}from"./useId-CahK3IZ3.js";import{u as de}from"./useListNavigation-Bf1PKTdz.js";import{C as pe}from"./Chip-Cc-5sX9a.js";import{I as be}from"./IconButton-BsqD9nTf.js";import{C as fe}from"./CheckIcon-CJPuDLts.js";import{A as ve}from"./ArrowVerticalAnimated-BAkArw06.js";import{I as ge}from"./InputGroup-BJwbXp8L.js";import{T as ye,a as ke,b as he}from"./TooltipTrigger-CBbkTK_V.js";/* empty css               */import"./_commonjsHelpers-DaWZu8wl.js";import"./tokens-CvksrKef.js";import"./useBrowserPreferences-B9LcbCiO.js";import"./usePreviousValue-f0kyfTHz.js";import"./CloseIcon-bvBUMA_V.js";import"./Icon-mINJCSxV.js";import"./ArrowUpIcon-CFNLzgG_.js";import"./Label-tZYmh4ng.js";import"./SupportLabel-Bm3W2hYF.js";import"./ErrorIcon-BUXYVAIL.js";import"./WarningIcon-CnuYLHnq.js";import"./getThemeAndDensity-CIeob-5A.js";import"./jsx-runtime-DqZpzl9T.js";import"./index-BdKvcPYQ.js";import"./index-yL1brwCS.js";function xe(s){return typeof s=="string"?{value:s,label:s}:s}const N=({id:s,placeholder:B,items:f,onChange:h,onFocus:A,onBlur:q,value:L,label:K,noMatchingOption:G,labelProps:H,helpLabel:J,errorLabel:R,width:U,density:X,name:c,className:z,invalid:Q,hasTagHover:W})=>{const u=me(s||"jkl-combobox",{generateSuffix:!s}),I=`${u}_label`,Y=`${u}_button`,Z=`${u}_search-input`,[n,v]=a.useState(L||[]),[i,m]=a.useState(!1),[b,g]=a.useState(""),[ee,te]=a.useState(!1),[O,S]=a.useState(!1),l=a.useRef(null),x=a.useRef(null),C=a.useRef(!1);a.useEffect(()=>{g(""),i&&l.current&&l.current.focus()},[i]),a.useEffect(()=>{v(e=>L||e)},[L]);const j=e=>n?n.some(t=>t.value===e.value):!1,E=a.useCallback(e=>n.filter(t=>t.value!==e),[n]),w=a.useCallback((e,t)=>{const o=E(t);v(o),h({type:"change",target:{name:c,value:t,selectedOptions:o}}),e.stopPropagation(),o.length===0&&S(!1)},[E,h,c]),ae=a.useCallback(e=>{let t;if(n.some(o=>o.value===e))t=E(e);else{const o=f.find(k=>k.value===e);t=[...n,o]}l.current?.focus(),v(t),h({type:"change",target:{name:c,value:e,selectedOptions:t}})},[n,h,c,E,f]),ne=e=>{l.current?.focus(),m(!0),g(e.target.value)},P=a.useMemo(()=>{if(!b)return f;const e=f.filter(t=>t.label.toLowerCase().indexOf(b.toLowerCase())>=0);return te(e.length===0),e},[b,f]),[re,oe]=a.useState(P[0]?.value?`${u}-${P[0]?.value}`:void 0),le=!i;a.useEffect(()=>{const e=t=>{t.key==="Escape"&&i&&m(!1)};return typeof window<"u"&&window.addEventListener("keydown",e),()=>{typeof window<"u"&&i&&window.removeEventListener("keydown",e)}},[i]);const V=a.useCallback(e=>{e?l.current&&l.current.focus():C.current&&x.current&&x.current.focus()},[]),y=a.useCallback(()=>{C.current||(A&&A({type:"change",target:{name:c,value:n?.[0].value||"",selectedOptions:n}}),C.current=!0,m(!0))},[A,n,c]),[d]=ce(i,{onFirstVisible:V,onTransitionEnd:V});de({ref:d});const D=a.useRef(null),p=a.useCallback(e=>{D.current?.contains(e.relatedTarget)||(g(""),q&&(q({type:"blur",target:{name:c,value:n?.[0]?.value||"",selectedOptions:n}}),x.current?.dispatchEvent(new Event("focusout",{bubbles:!0}))),C.current=!1,m(!1))},[q,c,n]),se=a.useCallback(e=>{e.target.focus({preventScroll:!0})},[]),ie=a.useCallback(e=>{if(e.key==="ArrowDown"){e.preventDefault(),e.stopPropagation();const t=d.current;t&&t.querySelector('[role="option"]')?.focus()}else e.key==="Escape"&&(e.preventDefault(),e.stopPropagation(),m(!1));if(e.metaKey&&e.key==="a"||e.ctrlKey&&e.key==="a"){e.preventDefault(),e.stopPropagation();const t=n.map(o=>({...o,isMarked:!0}));S(!0),v(t)}else if(e.key==="Backspace")if(e.stopPropagation(),S(!1),n.some(o=>o.isMarked)){const o=n.filter(k=>!k.isMarked);v(o),g("")}else n.length>0&&b===""&&w(e,n[n.length-1].value)},[n,b,d,w]),ue=a.useCallback(e=>{if(e.key==="Tab")l.current&&(e.preventDefault(),e.stopPropagation(),e.shiftKey||m(!1),l.current.focus());else if(e.key==="ArrowUp"&&d.current&&l.current){const t=d.current.querySelector('[role="option"]:not([hidden])');e.currentTarget.id===t?.id&&l.current&&l.current.focus()}},[d]),F=n.length>=1,$=a.useCallback(e=>r.createElement(pe,{key:e.value,"data-testid":"jkl-chip","aria-label":`Fjern ${e.tagLabel}`,className:`jkl-combobox__selected-option ${O&&"jkl-combobox__selected-option--marked"}`,variant:"input",onClick:t=>{l.current&&l.current.focus(),w(t,e.value)},onBlur:p},e.tagLabel?e.tagLabel:e.label),[p,w,O]);return r.createElement(ge,{label:K,id:Z,ref:D,"data-testid":"jkl-combobox",className:M("jkl-combobox",z,{"jkl-combobox--invalid":!!R||Q,"jkl-combobox--menu-open":i,"jkl-combobox--menu-closed":!i&&F}),labelProps:{id:I,...H},helpLabel:J,errorLabel:R,density:X,render:e=>r.createElement("div",{className:M("jkl-combobox__wrapper",{"jkl-combobox__wrapper--active-value":F}),style:{width:U},tabIndex:-1,onFocus:y,onBlur:p},r.createElement("div",{className:"jkl-combobox__chips","data-testid":"jkl-combobox__chips"},n.map(xe).map(t=>W?r.createElement(ye,{key:t.value},r.createElement(ke,null,$(t)),r.createElement(he,null,t.label)):$(t)),r.createElement("input",{...e,className:"jkl-combobox__search-input",onChange:ne,"data-testid":"jkl-combobox__search-input",onFocus:y,onBlur:p,onKeyDown:ie,value:b,ref:l,"aria-controls":u,role:"combobox","aria-autocomplete":"list","aria-expanded":i,placeholder:n.length>0?"":B,autoComplete:"off"})),r.createElement("div",{className:"jkl-combobox__menu",role:"listbox",ref:d,id:u,"aria-labelledby":I,"aria-multiselectable":"true","aria-activedescendant":re,onFocus:y,onBlur:p,tabIndex:-1},P.map((t,o)=>r.createElement("button",{key:`${u}-${t.value}`,type:"button",id:`${u}__${t.value}`,"aria-selected":j(t),role:"option",value:t.value,onBlur:p,className:`jkl-combobox__option ${j(t)&&"jkl-combobox__option--selected"}`,"data-testid":"jkl-combobox__option","data-testautoid":`jkl-combobox__option-${o}`,onFocus:y,onKeyDown:ue,onClick:k=>{oe(`${u}__${t.value}`),k.stopPropagation(),ae(t.value),g("")},onMouseOver:se},t.description?r.createElement("span",null,t.label,r.createElement("span",{className:"jkl-combobox__option-description"},t.description)):t.label,j(t)?r.createElement("span",null,r.createElement(fe,null)," "):null)),ee&&r.createElement("div",{className:"jkl-combobox__no-option"},G)),r.createElement("div",{className:"jkl-combobox__actions"},r.createElement(be,{id:Y,onFocus:y,onBlur:p,className:"jkl-combobox__button","data-testid":"jkl-combobox__button","aria-label":"Ã…pne meny","aria-expanded":i,"aria-controls":u,onClick:()=>m(t=>!t),onMouseDown:t=>{t.preventDefault(),x.current?.focus()}},r.createElement(ve,{pointingDown:le}))))})};N.displayName="Combobox";N.__docgenInfo={description:"",methods:[],displayName:"Combobox",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},"data-testautoid":{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},"data-testid":{required:!1,tsType:{name:"string"},description:""},density:{required:!1,tsType:{name:"union",raw:'"comfortable" | "compact"',elements:[{name:"literal",value:'"comfortable"'},{name:"literal",value:'"compact"'}]},description:""},errorLabel:{required:!1,tsType:{name:"string"},description:""},helpLabel:{required:!1,tsType:{name:"string"},description:""},inline:{required:!1,tsType:{name:"boolean"},description:""},label:{required:!0,tsType:{name:"string"},description:""},labelProps:{required:!1,tsType:{name:"Omit",elements:[{name:"LabelProps"},{name:"union",raw:'"children" | "density" | "htmlFor" | "standAlone"',elements:[{name:"literal",value:'"children"'},{name:"literal",value:'"density"'},{name:"literal",value:'"htmlFor"'},{name:"literal",value:'"standAlone"'}]}],raw:`Omit<
    LabelProps,
    "children" | "density" | "htmlFor" | "standAlone"
>`},description:""},supportLabelProps:{required:!1,tsType:{name:"Omit",elements:[{name:"SupportLabelProps"},{name:"union",raw:'"id" | "errorLabel" | "helpLabel" | "density"',elements:[{name:"literal",value:'"id"'},{name:"literal",value:'"errorLabel"'},{name:"literal",value:'"helpLabel"'},{name:"literal",value:'"density"'}]}],raw:`Omit<
    SupportLabelProps,
    "id" | "errorLabel" | "helpLabel" | "density"
>`},description:""},tooltip:{required:!1,tsType:{name:"ReactNode"},description:""},style:{required:!1,tsType:{name:"CSSProperties"},description:""},render:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: InputProps) => JSX.Element",signature:{arguments:[{type:{name:"InputProps"},name:"props"}],return:{name:"JSX.Element"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    value: string;
    label: string;
    description?: string;
}`,signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"Array<ValuePair>"},description:""},noMatchingOption:{required:!1,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    value: string;
    label: string;
    description?: string;
}`,signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"Array<ValuePair>"},description:""},width:{required:!1,tsType:{name:"string"},description:""},invalid:{required:!1,tsType:{name:"boolean"},description:""},hasTagHover:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""}}};const We={title:"Komponenter/Combobox",component:N,parameters:{layout:"centered"},tags:["autodocs"]},Ce=[{value:"a080",label:"A080 - Rotavirusenteritt",tagLabel:"A080"},{value:"a081",label:"A081 - Akutt gastroenteritt som skyldes norovirus",tagLabel:"A081"},{value:"a082",label:"A082 - Adenovirusenteritt",tagLabel:"A082"},{value:"a083",label:"A083 - Annen virusenteritt",tagLabel:"A083"},{value:"a084",label:"A084 - Uspesifisert virusinfeksjon i mage-tarmkanalen",tagLabel:"A084"},{value:"a085",label:"A085 - Annen spesifisert mage-tarminfeksjon",tagLabel:"A085"},{value:"a090",label:"A090 - Annen eller uspesifisert gastroenteritt eller kolitt av infeksiÃ¸s Ã¥rsak",tagLabel:"A090"},{value:"a099",label:"A099 - Gastroenteritt eller kolitt av uspesifisert Ã¥rsak",tagLabel:"A099"},{value:"a150",label:"A150 - Lungetuberkulose bekreftet ved mikroskopi av sputum med eller uten kultur",tagLabel:"A150"}],Ee=[{label:"DNB",value:"dnb"},{label:"Sparebank 1",value:"sb1"},{label:"Eika",value:"eik"},{label:"Fremtind",value:"fre"}],_={args:{items:Ce,label:"Velg sykdommer",name:"disease",onChange:()=>{}},decorators:s=>r.createElement("div",null,r.createElement(s,null))},T={name:"Combobox uten tag label",args:{items:Ee,label:"Filtrer",name:"filter",onChange:()=>{}},decorators:s=>r.createElement("div",null,r.createElement(s,null))};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`{
  args: {
    items,
    label: "Velg sykdommer",
    name: "disease",
    onChange: () => {}
  },
  decorators: Story => <div>
            <Story />
        </div>
}`,..._.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  name: "Combobox uten tag label",
  args: {
    items: itemsNoTagLabel,
    label: "Filtrer",
    name: "filter",
    onChange: () => {}
  },
  decorators: Story => <div>
            <Story />
        </div>
}`,...T.parameters?.docs?.source}}};const Ye=["Combobox","ComboboxNoTagLabel"];export{_ as Combobox,T as ComboboxNoTagLabel,Ye as __namedExportsOrder,We as default};
