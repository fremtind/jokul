import{r as a,j as r}from"./iframe-BbCvJXdR.js";import{c as D}from"./clsx-B-dksMZM.js";import{u as ce}from"./useAnimatedHeight-BLwDFli_.js";import{u as ue}from"./useId-BRz3euu1.js";import{u as de}from"./useListNavigation-C_qg4A-M.js";import{C as pe}from"./Chip-BcqY3rdl.js";import{I as me}from"./IconButton-LcXqAKoE.js";import{C as fe}from"./CheckIcon-B8UViMo1.js";import{A as be}from"./ArrowVerticalAnimated-nBTnwItI.js";import{I as ve}from"./InputGroup-DHFtBypR.js";import{T as ye,a as ge,b as he}from"./TooltipTrigger-C2tzA_GK.js";function xe(u){return typeof u=="string"?{value:u,label:u}:u}const $=({id:u,placeholder:F,items:b,onChange:x,onFocus:C,onBlur:T,value:q,label:M,noMatchingOption:B,labelProps:K,helpLabel:H,errorLabel:I,width:J,density:X,name:c,className:G,invalid:U,description:z,hasTagHover:Q})=>{const i=ue(u||"jkl-combobox",{generateSuffix:!u}),N=`${i}_label`,W=`${i}_button`,Y=`${i}_search-input`,[n,v]=a.useState(q||[]),[l,d]=a.useState(!1),[f,y]=a.useState(""),[Z,ee]=a.useState(!1),[R,P]=a.useState(!1),o=a.useRef(null),k=a.useRef(null),j=a.useRef(!1);a.useEffect(()=>{y(""),l&&o.current&&o.current.focus()},[l]),a.useEffect(()=>{v(e=>q||e)},[q]);const S=e=>n?n.some(t=>t.value===e.value):!1,w=a.useCallback(e=>n.filter(t=>t.value!==e),[n]),_=a.useCallback((e,t)=>{const s=w(t);v(s),x({type:"change",target:{name:c,value:t,selectedOptions:s}}),e.stopPropagation(),s.length===0&&P(!1)},[w,x,c]),te=a.useCallback(e=>{let t;if(n.some(s=>s.value===e))t=w(e);else{const s=b.find(h=>h.value===e);t=[...n,s]}o.current?.focus(),v(t),x({type:"change",target:{name:c,value:e,selectedOptions:t}})},[n,x,c,w,b]),ae=e=>{o.current?.focus(),d(!0),y(e.target.value)},E=a.useMemo(()=>{if(!f)return b;const e=b.filter(t=>t.label.toLowerCase().indexOf(f.toLowerCase())>=0);return ee(e.length===0),e},[f,b]),[ne,re]=a.useState(E[0]?.value?`${i}-${E[0]?.value}`:void 0),se=!l;a.useEffect(()=>{const e=t=>{t.key==="Escape"&&l&&d(!1)};return typeof window<"u"&&window.addEventListener("keydown",e),()=>{typeof window<"u"&&l&&window.removeEventListener("keydown",e)}},[l]);const L=a.useCallback(e=>{e?o.current&&o.current.focus():j.current&&k.current&&k.current.focus()},[]),g=a.useCallback(()=>{j.current||(C&&C({type:"change",target:{name:c,value:n?.[0].value||"",selectedOptions:n}}),j.current=!0,d(!0))},[C,n,c]),[p]=ce(l,{onFirstVisible:L,onTransitionEnd:L});de({ref:p});const O=a.useRef(null),m=a.useCallback(e=>{O.current?.contains(e.relatedTarget)||(y(""),T&&(T({type:"blur",target:{name:c,value:n?.[0]?.value||"",selectedOptions:n}}),k.current?.dispatchEvent(new Event("focusout",{bubbles:!0}))),j.current=!1,d(!1))},[T,c,n]),oe=a.useCallback(e=>{e.target.focus({preventScroll:!0})},[]),le=a.useCallback(e=>{if(e.key==="ArrowDown"){e.preventDefault(),e.stopPropagation();const t=p.current;t&&t.querySelector('[role="option"]')?.focus()}else e.key==="Escape"&&(e.preventDefault(),e.stopPropagation(),d(!1));if(e.metaKey&&e.key==="a"||e.ctrlKey&&e.key==="a"){e.preventDefault(),e.stopPropagation();const t=n.map(s=>({...s,isMarked:!0}));P(!0),v(t)}else if(e.key==="Backspace")if(e.stopPropagation(),P(!1),n.some(s=>s.isMarked)){const s=n.filter(h=>!h.isMarked);v(s),y("")}else n.length>0&&f===""&&_(e,n[n.length-1].value)},[n,f,p,_]),ie=a.useCallback(e=>{if(e.key==="Tab")o.current&&(e.preventDefault(),e.stopPropagation(),e.shiftKey||d(!1),o.current.focus());else if(e.key==="ArrowUp"&&p.current&&o.current){const t=p.current.querySelector('[role="option"]:not([hidden])');e.currentTarget.id===t?.id&&o.current&&o.current.focus()}},[p]),V=n.length>=1,A=a.useCallback(e=>r.jsx(pe,{"data-testid":"jkl-chip","aria-label":`Fjern ${e.tagLabel}`,className:`jkl-combobox__selected-option ${R&&"jkl-combobox__selected-option--marked"}`,variant:"input",onClick:t=>{o.current&&o.current.focus(),_(t,e.value)},onBlur:m,children:e.tagLabel?e.tagLabel:e.label},e.value),[m,_,R]);return r.jsx(ve,{label:M,id:Y,ref:O,"data-testid":"jkl-combobox",className:D("jkl-combobox",G,{"jkl-combobox--invalid":!!I||U,"jkl-combobox--menu-open":l,"jkl-combobox--menu-closed":!l&&V}),labelProps:{id:N,...K},helpLabel:H,errorLabel:I,density:X,description:z,render:e=>r.jsxs("div",{className:D("jkl-combobox__wrapper",{"jkl-combobox__wrapper--active-value":V}),style:{width:J},tabIndex:-1,onFocus:g,onBlur:m,children:[r.jsxs("div",{className:"jkl-combobox__chips","data-testid":"jkl-combobox__chips",children:[n.map(xe).map(t=>Q?r.jsxs(ye,{children:[r.jsx(ge,{children:A(t)}),r.jsx(he,{children:t.label})]},t.value):A(t)),r.jsx("input",{...e,className:"jkl-combobox__search-input",onChange:ae,"data-testid":"jkl-combobox__search-input",onFocus:g,onBlur:m,onKeyDown:le,value:f,ref:o,"aria-controls":i,role:"combobox","aria-autocomplete":"list","aria-expanded":l,placeholder:n.length>0?"":F,autoComplete:"off"})]}),r.jsxs("div",{className:"jkl-combobox__menu",role:"listbox",ref:p,id:i,"aria-labelledby":N,"aria-multiselectable":"true","aria-activedescendant":ne,onFocus:g,onBlur:m,tabIndex:-1,children:[E.map((t,s)=>r.jsxs("button",{type:"button",id:`${i}__${t.value}`,"aria-selected":S(t),role:"option",value:t.value,onBlur:m,className:`jkl-combobox__option ${S(t)&&"jkl-combobox__option--selected"}`,"data-testid":"jkl-combobox__option","data-testautoid":`jkl-combobox__option-${s}`,onFocus:g,onKeyDown:ie,onClick:h=>{re(`${i}__${t.value}`),h.stopPropagation(),te(t.value),y("")},onMouseOver:oe,children:[t.description?r.jsxs("span",{children:[t.label,r.jsx("span",{className:"jkl-combobox__option-description",children:t.description})]}):t.label,S(t)?r.jsxs("span",{children:[r.jsx(fe,{})," "]}):null]},`${i}-${t.value}`)),Z&&r.jsx("div",{className:"jkl-combobox__no-option",children:B})]}),r.jsx("div",{className:"jkl-combobox__actions",children:r.jsx(me,{id:W,onFocus:g,onBlur:m,className:"jkl-combobox__button","data-testid":"jkl-combobox__button","aria-label":"Ã…pne meny","aria-expanded":l,"aria-controls":i,onClick:()=>d(t=>!t),onMouseDown:t=>{t.preventDefault(),k.current?.focus()},children:r.jsx(be,{pointingDown:se})})})]})})};$.displayName="Combobox";$.__docgenInfo={description:"",methods:[],displayName:"Combobox",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},"data-testautoid":{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},"data-testid":{required:!1,tsType:{name:"string"},description:""},density:{required:!1,tsType:{name:"union",raw:'"comfortable" | "compact"',elements:[{name:"literal",value:'"comfortable"'},{name:"literal",value:'"compact"'}]},description:""},errorLabel:{required:!1,tsType:{name:"string"},description:""},helpLabel:{required:!1,tsType:{name:"string"},description:""},inline:{required:!1,tsType:{name:"boolean"},description:""},label:{required:!0,tsType:{name:"string"},description:""},labelProps:{required:!1,tsType:{name:"Omit",elements:[{name:"LabelProps"},{name:"union",raw:'"children" | "density" | "htmlFor" | "standAlone"',elements:[{name:"literal",value:'"children"'},{name:"literal",value:'"density"'},{name:"literal",value:'"htmlFor"'},{name:"literal",value:'"standAlone"'}]}],raw:`Omit<
    LabelProps,
    "children" | "density" | "htmlFor" | "standAlone"
>`},description:""},supportLabelProps:{required:!1,tsType:{name:"Omit",elements:[{name:"SupportLabelProps"},{name:"union",raw:'"id" | "errorLabel" | "helpLabel" | "density"',elements:[{name:"literal",value:'"id"'},{name:"literal",value:'"errorLabel"'},{name:"literal",value:'"helpLabel"'},{name:"literal",value:'"density"'}]}],raw:`Omit<
    SupportLabelProps,
    "id" | "errorLabel" | "helpLabel" | "density"
>`},description:""},description:{required:!1,tsType:{name:"string"},description:""},tooltip:{required:!1,tsType:{name:"ReactNode"},description:""},style:{required:!1,tsType:{name:"CSSProperties"},description:""},render:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: InputProps) => JSX.Element",signature:{arguments:[{type:{name:"InputProps"},name:"props"}],return:{name:"JSX.Element"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    value: string;
    label: string;
    description?: string;
}`,signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"Array<ValuePair>"},description:""},noMatchingOption:{required:!1,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    value: string;
    label: string;
    description?: string;
}`,signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"Array<ValuePair>"},description:""},width:{required:!1,tsType:{name:"string"},description:""},invalid:{required:!1,tsType:{name:"boolean"},description:""},hasTagHover:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    event: ComboboxPartialChangeEvent,
) => void`,signature:{arguments:[{type:{name:"ComboboxPartialChangeEvent"},name:"event"}],return:{name:"void"}}},description:""}}};export{$ as C};
