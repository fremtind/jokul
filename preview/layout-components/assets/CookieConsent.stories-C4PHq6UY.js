import{j as s}from"./jsx-runtime-BbjHj44Y.js";import{r as p,R as L}from"./index-C6mWTJJr.js";import{S as R,P as U}from"./Button-V_7JZhcr.js";import{r as J,h as V}from"./index-zunobDwC.js";import{M as Y,a as z,b as X,c as Q,d as Z,f as ee,g as te}from"./Modal-Cw5Em_9Q.js";import{a as ne}from"./_commonjsHelpers-BosuxZz1.js";import{p as ie}from"./index-Dk74W0Oi.js";import{u as oe}from"./useId-Cim48cX5.js";import{C as ae}from"./Checkbox-CCWt9Wyd.js";import"./clsx-B-dksMZM.js";import"./usePreviousValue-ByfnePFg.js";import"./Loader-BdwWmQR7.js";import"./useDelayedRender-B8sMdCvv.js";import"./IconButton-DhDUYojH.js";import"./CloseIcon-15a5PzcQ.js";import"./Icon-CZwjvlw8.js";var C={},re=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'],se="Tab",le="Escape";function h(e){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this.$el=e,this.shown=!1,this._id=this.$el.getAttribute("data-a11y-dialog")||this.$el.id,this._previouslyFocused=null,this._listeners={},this.create()}h.prototype.create=function(){this.$el.setAttribute("aria-hidden",!0),this.$el.setAttribute("aria-modal",!0),this.$el.setAttribute("tabindex",-1),this.$el.hasAttribute("role")||this.$el.setAttribute("role","dialog"),this._openers=_('[data-a11y-dialog-show="'+this._id+'"]'),this._openers.forEach((function(t){t.addEventListener("click",this._show)}).bind(this));const e=this.$el;return this._closers=_("[data-a11y-dialog-hide]",this.$el).filter(function(t){return t.closest('[aria-modal="true"], [data-a11y-dialog]')===e}).concat(_('[data-a11y-dialog-hide="'+this._id+'"]')),this._closers.forEach((function(t){t.addEventListener("click",this._hide)}).bind(this)),this._fire("create"),this};h.prototype.show=function(e){return this.shown?this:(this._previouslyFocused=document.activeElement,this.$el.removeAttribute("aria-hidden"),this.shown=!0,P(this.$el),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",e),this)};h.prototype.hide=function(e){return this.shown?(this.shown=!1,this.$el.setAttribute("aria-hidden","true"),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",e),this):this};h.prototype.destroy=function(){return this.hide(),this._openers.forEach((function(e){e.removeEventListener("click",this._show)}).bind(this)),this._closers.forEach((function(e){e.removeEventListener("click",this._hide)}).bind(this)),this._fire("destroy"),this._listeners={},this};h.prototype.on=function(e,t){return typeof this._listeners[e]>"u"&&(this._listeners[e]=[]),this._listeners[e].push(t),this};h.prototype.off=function(e,t){var n=(this._listeners[e]||[]).indexOf(t);return n>-1&&this._listeners[e].splice(n,1),this};h.prototype._fire=function(e,t){var n=this._listeners[e]||[],i=new CustomEvent(e,{detail:t});this.$el.dispatchEvent(i),n.forEach((function(o){o(this.$el,t)}).bind(this))};h.prototype._bindKeypress=function(e){const t=document.activeElement;t&&t.closest('[aria-modal="true"]')!==this.$el||(this.shown&&e.key===le&&this.$el.getAttribute("role")!=="alertdialog"&&(e.preventDefault(),this.hide(e)),this.shown&&e.key===se&&ce(this.$el,e))};h.prototype._maintainFocus=function(e){this.shown&&!e.target.closest('[aria-modal="true"]')&&!e.target.closest("[data-a11y-dialog-ignore-focus-trap]")&&P(this.$el)};function ue(e){return Array.prototype.slice.call(e)}function _(e,t){return ue((t||document).querySelectorAll(e))}function P(e){var t=e.querySelector("[autofocus]")||e;t.focus()}function de(e){return _(re.join(","),e).filter(function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)})}function ce(e,t){var n=de(e),i=n.indexOf(document.activeElement);t.shiftKey&&i===0?(n[n.length-1].focus(),t.preventDefault()):!t.shiftKey&&i===n.length-1&&(n[0].focus(),t.preventDefault())}function $(){_("[data-a11y-dialog]").forEach(function(e){new h(e)})}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",$):window.requestAnimationFrame?window.requestAnimationFrame($):window.setTimeout($,16));const fe=Object.freeze(Object.defineProperty({__proto__:null,default:h},Symbol.toStringTag,{value:"Module"})),me=ne(fe);Object.defineProperty(C,"__esModule",{value:!0});var F=C.useA11yDialog=C.A11yDialog=void 0,f=A(p),he=A(J),ge=A(me),d=A(ie);function A(e){return e&&e.__esModule?e:{default:e}}function v(){return v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},v.apply(this,arguments)}function D(e,t){return ke(e)||ve(e,t)||ye(e,t)||pe()}function pe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ye(e,t){if(e){if(typeof e=="string")return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}function N(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ve(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],i=!0,o=!1,a=void 0;try{for(var l=e[Symbol.iterator](),u;!(i=(u=l.next()).done)&&(n.push(u.value),!(t&&n.length===t));i=!0);}catch(c){o=!0,a=c}finally{try{!i&&l.return!=null&&l.return()}finally{if(o)throw a}}return n}}function ke(e){if(Array.isArray(e))return e}var be=function(){var t=f.default.useState(!1),n=D(t,2),i=n[0],o=n[1];return f.default.useEffect(function(){return o(!0)},[]),i},_e=function(){var t=f.default.useState(null),n=D(t,2),i=n[0],o=n[1],a=f.default.useCallback(function(l){l!==null&&o(new ge.default(l))},[]);return[i,a]},K=function(t){var n=_e(),i=D(n,2),o=i[0],a=i[1],l=f.default.useCallback(function(){return o.hide()},[o]),u=t.role||"dialog",c=u==="alertdialog",m=t.titleId||t.id+"-title";return f.default.useEffect(function(){return function(){o&&o.destroy()}},[o]),[o,{container:{id:t.id,ref:a,role:u,tabIndex:-1,"aria-modal":!0,"aria-hidden":!0,"aria-labelledby":m},overlay:{onClick:c?void 0:l},dialog:{role:"document"},closeButton:{type:"button",onClick:l},title:{role:"heading","aria-level":1,id:m}}]};F=C.useA11yDialog=K;var T=function(t){var n=be(),i=K(t),o=D(i,2),a=o[0],l=o[1],u=t.dialogRef;if(f.default.useEffect(function(){return a&&u(a),function(){return u(void 0)}},[u,a]),!n)return null;var c=t.dialogRoot?document.querySelector(t.dialogRoot):document.body,m=f.default.createElement("p",v({},l.title,{className:t.classNames.title,key:"title"}),t.title),g=f.default.createElement("button",v({},l.closeButton,{className:t.classNames.closeButton,"aria-label":t.closeButtonLabel,key:"button"}),t.closeButtonContent),r=[t.closeButtonPosition==="first"&&g,m,t.children,t.closeButtonPosition==="last"&&g].filter(Boolean);return he.default.createPortal(f.default.createElement("div",v({},l.container,{className:t.classNames.container}),f.default.createElement("div",v({},l.overlay,{className:t.classNames.overlay})),f.default.createElement("div",v({},l.dialog,{className:t.classNames.dialog}),r)),c)};C.A11yDialog=T;T.defaultProps={role:"dialog",closeButtonLabel:"Close this dialog window",closeButtonContent:"×",closeButtonPosition:"first",classNames:{},dialogRef:function(){}};T.propTypes={role:d.default.oneOf(["dialog","alertdialog"]),id:d.default.string.isRequired,title:d.default.node.isRequired,dialogRef:d.default.func,titleId:d.default.string,closeButtonLabel:d.default.string,closeButtonContent:d.default.node,closeButtonPosition:d.default.oneOf(["first","last","none"]),dialogRoot:d.default.string,classNames:d.default.exact({container:d.default.string,overlay:d.default.string,dialog:d.default.string,title:d.default.string,closeButton:d.default.string}),children:d.default.node};function Ce(e){const{id:t,role:n="dialog",closeButtonLabel:i="Lukk",...o}=e,a=oe(t||"jkl-modal",{generateSuffix:!t}),[l,u]=F({id:a,role:n,...o}),{dialog:c,...m}=u,g={modal:u.dialog,...m,closeButton:{...u.closeButton,"aria-label":i}};return[l,g]}const xe=e=>{if(typeof document>"u")return;const t=document.cookie.split(";").map(n=>n.trim().split("=")).find(n=>n[0]===e);if(t)return t},je=({adapter:e,name:t})=>{const n=xe(t);if(n)return JSON.parse(n[1]);if(e)return e()},we=10368e3,Ee=({consent:e,maxAge:t=we,name:n,domain:i,path:o})=>{document.cookie=[`${n}=${JSON.stringify(e)}`,`max-age=${t}`,"SameSite=Lax",!!i&&`domain=${i}`,!!o&&`path=${o}`].filter(a=>a).join(";")},Ae=(e,t)=>{if(!t)return Object.values(e).some(o=>o);const n=new Map(Object.entries(t)),i=Object.entries(e);for(const[o,a]of i)if(a&&n.get(o)===null)return!0;return!1},S=e=>typeof e>"u"?null:e===!1||String(e).toLowerCase()==="false"?"denied":"accepted",I=(e,t)=>({functional:t.functional?S(e.functional):void 0,statistics:t.statistics?S(e.statistics):void 0,marketing:t.marketing?S(e.marketing):void 0}),De=({marketing:e,functional:t,statistics:n})=>({...e&&{marketing:e},...t&&{functional:t},...n&&{statistics:n}}),$e="fremtind-cookie-consent",O=L.createContext(void 0),W=({children:e,cookieAdapter:t,marketing:n,functional:i,statistics:o,cookieName:a=$e,cookieDomain:l,cookiePath:u})=>{const[c,m]=p.useState(()=>Date.now()),g=p.useMemo(()=>De({marketing:n,functional:i,statistics:o}),[n,i,o]),r=p.useMemo(()=>je({adapter:t,name:a})??{marketing:null,functional:null,statistics:null},[t,a,c]),[k,x]=p.useState(()=>Ae(g,r));return s.jsx(O.Provider,{value:{isOpen:k,setIsOpen:x,updateCurrentConsents:()=>m(Date.now()),requirement:g,currentConsent:r,cookieName:a,cookieDomain:l,cookiePath:u},children:e})},Se=()=>{const e=L.useContext(O);if(e===void 0)throw new Error("CookieConsent must be used within a CookieConsentProvider");return e},Te=()=>{const e=p.useContext(O);if(e===void 0)throw new Error("useCookieConsent must be used within a CookieConsentProvider");const t=()=>{e.setIsOpen(!0)},n=e.currentConsent;return{openConsentModal:t,consents:n}};W.__docgenInfo={description:"",methods:[],displayName:"CookieConsentProvider",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},cookieAdapter:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Consent | undefined",signature:{arguments:[],return:{name:"union",raw:"Consent | undefined",elements:[{name:"signature",type:"object",raw:`{
    marketing?: ConsentState;
    functional?: ConsentState;
    statistics?: ConsentState;
}`,signature:{properties:[{key:"marketing",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"functional",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"statistics",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}}]}},{name:"undefined"}]}}},description:""},cookieName:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"fremtind-cookie-consent"',computed:!1}},cookieDomain:{required:!1,tsType:{name:"string"},description:""},cookiePath:{required:!1,tsType:{name:"string"},description:""}}};const E=({defaultChecked:e,name:t,label:n,children:i})=>s.jsxs(s.Fragment,{children:[s.jsx(ae,{className:"jkl-cookie-consent-modal__checkbox",value:"true",name:t,defaultChecked:e,children:n}),s.jsx("p",{className:"jkl-cookie-consent-modal__info-text",children:i})]});E.__docgenInfo={description:"",methods:[],displayName:"RequirementCheckbox",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},defaultChecked:{required:!0,tsType:{name:"boolean"},description:""},name:{required:!0,tsType:{name:"union",raw:'"functional" | "marketing" | "statistics"',elements:[{name:"literal",value:'"functional"'},{name:"literal",value:'"marketing"'},{name:"literal",value:'"statistics"'}]},description:""},label:{required:!0,tsType:{name:"string"},description:""}}};const Oe=({blocking:e,onAccept:t,...n})=>{const{currentConsent:i,cookieName:o,cookieDomain:a,cookiePath:l,requirement:u,isOpen:c,setIsOpen:m,updateCurrentConsents:g}=Se(),[r,k]=Ce({id:`jkl-cookie-modal-${p.useId()}`,role:e?"alertdialog":"dialog",title:"Informasjonskapsler"});if(p.useEffect(()=>{c?r==null||r.show():r==null||r.hide()},[r,c]),p.useEffect(()=>{const y=()=>m(!1);return r==null||r.on("hide",y),()=>{r==null||r.off("hide",y)}},[r,m]),typeof document>"u")return null;if(typeof navigator<"u"&&!navigator.cookieEnabled)return t&&t({functional:"denied",marketing:"denied",statistics:"denied"}),null;const x=(y=I({functional:!0,statistics:!0,marketing:!0},u))=>{const b=Object.fromEntries(Object.entries(y).filter(([,G])=>typeof G<"u")),j={...i,...b};Ee({consent:j,name:o,domain:a,path:l}),g(),t==null||t(j),r==null||r.hide()},H=y=>{y.preventDefault();const b=new FormData(y.currentTarget),j=I({functional:b.get("functional")==="true",statistics:b.get("statistics")==="true",marketing:b.get("marketing")==="true"},u);x(j)};return V.createPortal(s.jsxs(Y,{...k.container,...n,"data-cookie-consent-open":c,children:[s.jsx(z,{...k.overlay}),s.jsxs(X,{component:"form",...k.modal,onSubmit:H,children:[s.jsx(Q,{children:s.jsx(Z,{...k.title,children:"Velg informasjonskapsler"})}),s.jsxs(ee,{children:[s.jsx("p",{children:"For at nettsidene skal fungere må vi bruke tekniske informasjonskaplser. Disse lagres derfor uten samtykke."}),u.functional&&s.jsx(E,{name:"functional",label:"Tillat funksjonelle",defaultChecked:i.functional==="accepted",children:"Funksjonelle informasjonskapsler lagrer opplysninger om din bruk av nettsidene og hvilke innstillinger du har gjort, slik at du kan få funksjonalitet tilpasset deg."},`functional-${i.functional}`),u.statistics&&s.jsx(E,{name:"statistics",label:"Tillat statistikk",defaultChecked:i.statistics==="accepted",children:"Informasjonskapslene lagrer statistikk som hjelper oss med å forstå hvordan nettsidene blir brukt, slik at vi kan gjøre dem bedre og enklere å bruke."},`statistics-${i.statistics}`),u.marketing&&s.jsx(E,{name:"marketing",label:"Tillat personlig markedsføring",defaultChecked:i.marketing==="accepted",children:"Dette gjør at vi kan gi deg mer relevant og tilpasset markedsføring, også gjennom våre samarbeidspartnere, på for eksempel nettsider, annonser og i sosiale medier."},`marketing-${i.marketing}`)]}),s.jsxs(te,{children:[s.jsx(R,{"data-testid":"jkl-cookie-consent-godta-alle",type:"button",onClick:()=>x(),children:"Godta alle"}),s.jsx(R,{"data-testid":"jkl-cookie-consent-godta",type:"submit",children:"Godta mine valg"})]})]})]}),document.body)},ze={title:"Komponenter/CookieConsent",component:W,parameters:{layout:"centered"},tags:["autodocs"],argTypes:{}},Re=({children:e})=>{const{openConsentModal:t}=Te();return s.jsxs("div",{children:[s.jsx(U,{onClick:()=>t(),children:"Åpne samtykker"}),e]})},w={args:{children:s.jsx(Re,{children:s.jsx(Oe,{})}),cookieName:"demo-consent-cookie",functional:!0,statistics:!0,marketing:!0}};var M,q,B;w.parameters={...w.parameters,docs:{...(M=w.parameters)==null?void 0:M.docs,source:{originalSource:`{
  args: {
    children: <Wrapper>
                <CookieConsentComponent />
            </Wrapper>,
    cookieName: "demo-consent-cookie",
    functional: true,
    statistics: true,
    marketing: true
  }
}`,...(B=(q=w.parameters)==null?void 0:q.docs)==null?void 0:B.source}}};const Xe=["CookieConsent"];export{w as CookieConsent,Xe as __namedExportsOrder,ze as default};
