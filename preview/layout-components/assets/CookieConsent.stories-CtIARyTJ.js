import{j as l}from"./jsx-runtime-D9p_MChh.js";import{a as J,r as j,R as W}from"./index-CRL2yuNo.js";import{S as M,P as V}from"./Button-BPhaSTk9.js";import{h as Y}from"./index-DO_xWACW.js";import{M as z,a as X,b as Q,c as Z,d as ee,f as te,g as ne}from"./Modal-CV2OP5Lj.js";import{r as ie}from"./index-BI6CK2Jw.js";import{a as oe}from"./_commonjsHelpers-gnU0ypJ3.js";import{r as ae}from"./index-Chjiymov.js";import{u as re}from"./useId-BJAJhdYZ.js";import{C as se}from"./Checkbox-DROFM54e.js";import"./clsx-B-dksMZM.js";import"./usePreviousValue-B4HAJZS8.js";import"./Loader-BBBxl9FC.js";import"./useDelayedRender-ClAGw7sE.js";import"./IconButton-BK1PK2Od.js";import"./CloseIcon-BmhIuoBP.js";import"./Icon-BsB2AusX.js";var w={},le=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'],ue="Tab",de="Escape";function p(e){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this.$el=e,this.shown=!1,this._id=this.$el.getAttribute("data-a11y-dialog")||this.$el.id,this._previouslyFocused=null,this._listeners={},this.create()}p.prototype.create=function(){this.$el.setAttribute("aria-hidden",!0),this.$el.setAttribute("aria-modal",!0),this.$el.setAttribute("tabindex",-1),this.$el.hasAttribute("role")||this.$el.setAttribute("role","dialog"),this._openers=D('[data-a11y-dialog-show="'+this._id+'"]'),this._openers.forEach((function(t){t.addEventListener("click",this._show)}).bind(this));const e=this.$el;return this._closers=D("[data-a11y-dialog-hide]",this.$el).filter(function(t){return t.closest('[aria-modal="true"], [data-a11y-dialog]')===e}).concat(D('[data-a11y-dialog-hide="'+this._id+'"]')),this._closers.forEach((function(t){t.addEventListener("click",this._hide)}).bind(this)),this._fire("create"),this};p.prototype.show=function(e){return this.shown?this:(this._previouslyFocused=document.activeElement,this.$el.removeAttribute("aria-hidden"),this.shown=!0,H(this.$el),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",e),this)};p.prototype.hide=function(e){return this.shown?(this.shown=!1,this.$el.setAttribute("aria-hidden","true"),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",e),this):this};p.prototype.destroy=function(){return this.hide(),this._openers.forEach((function(e){e.removeEventListener("click",this._show)}).bind(this)),this._closers.forEach((function(e){e.removeEventListener("click",this._hide)}).bind(this)),this._fire("destroy"),this._listeners={},this};p.prototype.on=function(e,t){return typeof this._listeners[e]>"u"&&(this._listeners[e]=[]),this._listeners[e].push(t),this};p.prototype.off=function(e,t){var a=(this._listeners[e]||[]).indexOf(t);return a>-1&&this._listeners[e].splice(a,1),this};p.prototype._fire=function(e,t){var a=this._listeners[e]||[],i=new CustomEvent(e,{detail:t});this.$el.dispatchEvent(i),a.forEach((function(u){u(this.$el,t)}).bind(this))};p.prototype._bindKeypress=function(e){const t=document.activeElement;t&&t.closest('[aria-modal="true"]')!==this.$el||(this.shown&&e.key===de&&this.$el.getAttribute("role")!=="alertdialog"&&(e.preventDefault(),this.hide(e)),this.shown&&e.key===ue&&me(this.$el,e))};p.prototype._maintainFocus=function(e){this.shown&&!e.target.closest('[aria-modal="true"]')&&!e.target.closest("[data-a11y-dialog-ignore-focus-trap]")&&H(this.$el)};function ce(e){return Array.prototype.slice.call(e)}function D(e,t){return ce((t||document).querySelectorAll(e))}function H(e){var t=e.querySelector("[autofocus]")||e;t.focus()}function fe(e){return D(le.join(","),e).filter(function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)})}function me(e,t){var a=fe(e),i=a.indexOf(document.activeElement);t.shiftKey&&i===0?(a[a.length-1].focus(),t.preventDefault()):!t.shiftKey&&i===a.length-1&&(a[0].focus(),t.preventDefault())}function O(){D("[data-a11y-dialog]").forEach(function(e){new p(e)})}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",O):window.requestAnimationFrame?window.requestAnimationFrame(O):window.setTimeout(O,16));const he=Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"})),ge=oe(he);var B;function pe(){if(B)return w;B=1,Object.defineProperty(w,"__esModule",{value:!0}),w.useA11yDialog=w.A11yDialog=void 0;var e=u(J()),t=u(ie()),a=u(ge),i=u(ae());function u(o){return o&&o.__esModule?o:{default:o}}function d(){return d=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(o[c]=r[c])}return o},d.apply(this,arguments)}function y(o,n){return s(o)||C(o,n)||_(o,n)||h()}function h(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _(o,n){if(o){if(typeof o=="string")return k(o,n);var r=Object.prototype.toString.call(o).slice(8,-1);if(r==="Object"&&o.constructor&&(r=o.constructor.name),r==="Map"||r==="Set")return Array.from(o);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(o,n)}}function k(o,n){(n==null||n>o.length)&&(n=o.length);for(var r=0,c=new Array(n);r<n;r++)c[r]=o[r];return c}function C(o,n){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(o)))){var r=[],c=!0,f=!1,v=void 0;try{for(var m=o[Symbol.iterator](),b;!(c=(b=m.next()).done)&&(r.push(b.value),!(n&&r.length===n));c=!0);}catch(A){f=!0,v=A}finally{try{!c&&m.return!=null&&m.return()}finally{if(f)throw v}}return r}}function s(o){if(Array.isArray(o))return o}var x=function(){var n=e.default.useState(!1),r=y(n,2),c=r[0],f=r[1];return e.default.useEffect(function(){return f(!0)},[]),c},E=function(){var n=e.default.useState(null),r=y(n,2),c=r[0],f=r[1],v=e.default.useCallback(function(m){m!==null&&f(new a.default(m))},[]);return[c,v]},$=function(n){var r=E(),c=y(r,2),f=c[0],v=c[1],m=e.default.useCallback(function(){return f.hide()},[f]),b=n.role||"dialog",A=b==="alertdialog",S=n.titleId||n.id+"-title";return e.default.useEffect(function(){return function(){f&&f.destroy()}},[f]),[f,{container:{id:n.id,ref:v,role:b,tabIndex:-1,"aria-modal":!0,"aria-hidden":!0,"aria-labelledby":S},overlay:{onClick:A?void 0:m},dialog:{role:"document"},closeButton:{type:"button",onClick:m},title:{role:"heading","aria-level":1,id:S}}]};w.useA11yDialog=$;var g=function(n){var r=x(),c=$(n),f=y(c,2),v=f[0],m=f[1],b=n.dialogRef;if(e.default.useEffect(function(){return v&&b(v),function(){return b(void 0)}},[b,v]),!r)return null;var A=n.dialogRoot?document.querySelector(n.dialogRoot):document.body,S=e.default.createElement("p",d({},m.title,{className:n.classNames.title,key:"title"}),n.title),I=e.default.createElement("button",d({},m.closeButton,{className:n.classNames.closeButton,"aria-label":n.closeButtonLabel,key:"button"}),n.closeButtonContent),U=[n.closeButtonPosition==="first"&&I,S,n.children,n.closeButtonPosition==="last"&&I].filter(Boolean);return t.default.createPortal(e.default.createElement("div",d({},m.container,{className:n.classNames.container}),e.default.createElement("div",d({},m.overlay,{className:n.classNames.overlay})),e.default.createElement("div",d({},m.dialog,{className:n.classNames.dialog}),U)),A)};return w.A11yDialog=g,g.defaultProps={role:"dialog",closeButtonLabel:"Close this dialog window",closeButtonContent:"×",closeButtonPosition:"first",classNames:{},dialogRef:function(){}},g.propTypes={role:i.default.oneOf(["dialog","alertdialog"]),id:i.default.string.isRequired,title:i.default.node.isRequired,dialogRef:i.default.func,titleId:i.default.string,closeButtonLabel:i.default.string,closeButtonContent:i.default.node,closeButtonPosition:i.default.oneOf(["first","last","none"]),dialogRoot:i.default.string,classNames:i.default.exact({container:i.default.string,overlay:i.default.string,dialog:i.default.string,title:i.default.string,closeButton:i.default.string}),children:i.default.node},w}var ye=pe();function ve(e){const{id:t,role:a="dialog",closeButtonLabel:i="Lukk",...u}=e,d=re(t||"jkl-modal",{generateSuffix:!t}),[y,h]=ye.useA11yDialog({id:d,role:a,...u}),{dialog:_,...k}=h,C={modal:h.dialog,...k,closeButton:{...h.closeButton,"aria-label":i}};return[y,C]}const ke=e=>{if(typeof document>"u")return;const t=document.cookie.split(";").map(a=>a.trim().split("=")).find(a=>a[0]===e);if(t)return t},be=({adapter:e,name:t})=>{const a=ke(t);if(a)return JSON.parse(a[1]);if(e)return e()},_e=10368e3,Ce=({consent:e,maxAge:t=_e,name:a,domain:i,path:u})=>{document.cookie=[`${a}=${JSON.stringify(e)}`,`max-age=${t}`,"SameSite=Lax",!!i&&`domain=${i}`,!!u&&`path=${u}`].filter(d=>d).join(";")},xe=(e,t)=>{if(!t)return Object.values(e).some(u=>u);const a=new Map(Object.entries(t)),i=Object.entries(e);for(const[u,d]of i)if(d&&a.get(u)===null)return!0;return!1},N=e=>typeof e>"u"?null:e===!1||String(e).toLowerCase()==="false"?"denied":"accepted",P=(e,t)=>({functional:t.functional?N(e.functional):void 0,statistics:t.statistics?N(e.statistics):void 0,marketing:t.marketing?N(e.marketing):void 0}),je=({marketing:e,functional:t,statistics:a})=>({...e&&{marketing:e},...t&&{functional:t},...a&&{statistics:a}}),we="fremtind-cookie-consent",q=W.createContext(void 0),G=({children:e,cookieAdapter:t,marketing:a,functional:i,statistics:u,cookieName:d=we,cookieDomain:y,cookiePath:h})=>{const[_,k]=j.useState(()=>Date.now()),C=j.useMemo(()=>je({marketing:a,functional:i,statistics:u}),[a,i,u]),s=j.useMemo(()=>be({adapter:t,name:d})??{marketing:null,functional:null,statistics:null},[t,d,_]),[x,E]=j.useState(()=>xe(C,s));return l.jsx(q.Provider,{value:{isOpen:x,setIsOpen:E,updateCurrentConsents:()=>k(Date.now()),requirement:C,currentConsent:s,cookieName:d,cookieDomain:y,cookiePath:h},children:e})},Ee=()=>{const e=W.useContext(q);if(e===void 0)throw new Error("CookieConsent must be used within a CookieConsentProvider");return e},Ae=()=>{const e=j.useContext(q);if(e===void 0)throw new Error("useCookieConsent must be used within a CookieConsentProvider");const t=()=>{e.setIsOpen(!0)},a=e.currentConsent;return{openConsentModal:t,consents:a}};G.__docgenInfo={description:"",methods:[],displayName:"CookieConsentProvider",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},cookieAdapter:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Consent | undefined",signature:{arguments:[],return:{name:"union",raw:"Consent | undefined",elements:[{name:"signature",type:"object",raw:`{
    marketing?: ConsentState;
    functional?: ConsentState;
    statistics?: ConsentState;
}`,signature:{properties:[{key:"marketing",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"functional",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}},{key:"statistics",value:{name:"union",raw:'null | "denied" | "accepted"',elements:[{name:"null"},{name:"literal",value:'"denied"'},{name:"literal",value:'"accepted"'}],required:!1}}]}},{name:"undefined"}]}}},description:""},cookieName:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"fremtind-cookie-consent"',computed:!1}},cookieDomain:{required:!1,tsType:{name:"string"},description:""},cookiePath:{required:!1,tsType:{name:"string"},description:""}}};const T=({defaultChecked:e,name:t,label:a,children:i})=>l.jsxs(l.Fragment,{children:[l.jsx(se,{className:"jkl-cookie-consent-modal__checkbox",value:"true",name:t,defaultChecked:e,children:a}),l.jsx("p",{className:"jkl-cookie-consent-modal__info-text",children:i})]});T.__docgenInfo={description:"",methods:[],displayName:"RequirementCheckbox",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},defaultChecked:{required:!0,tsType:{name:"boolean"},description:""},name:{required:!0,tsType:{name:"union",raw:'"functional" | "marketing" | "statistics"',elements:[{name:"literal",value:'"functional"'},{name:"literal",value:'"marketing"'},{name:"literal",value:'"statistics"'}]},description:""},label:{required:!0,tsType:{name:"string"},description:""}}};const De=({blocking:e,onAccept:t,...a})=>{const{currentConsent:i,cookieName:u,cookieDomain:d,cookiePath:y,requirement:h,isOpen:_,setIsOpen:k,updateCurrentConsents:C}=Ee(),[s,x]=ve({id:`jkl-cookie-modal-${j.useId()}`,role:e?"alertdialog":"dialog",title:"Informasjonskapsler"});if(j.useEffect(()=>{_?s==null||s.show():s==null||s.hide()},[s,_]),j.useEffect(()=>{const g=()=>k(!1);return s==null||s.on("hide",g),()=>{s==null||s.off("hide",g)}},[s,k]),typeof document>"u")return null;if(typeof navigator<"u"&&!navigator.cookieEnabled)return t&&t({functional:"denied",marketing:"denied",statistics:"denied"}),null;const E=(g=P({functional:!0,statistics:!0,marketing:!0},h))=>{const o=Object.fromEntries(Object.entries(g).filter(([,r])=>typeof r<"u")),n={...i,...o};Ce({consent:n,name:u,domain:d,path:y}),C(),t==null||t(n),s==null||s.hide()},$=g=>{g.preventDefault();const o=new FormData(g.currentTarget),n=P({functional:o.get("functional")==="true",statistics:o.get("statistics")==="true",marketing:o.get("marketing")==="true"},h);E(n)};return Y.createPortal(l.jsxs(z,{...x.container,...a,"data-cookie-consent-open":_,children:[l.jsx(X,{...x.overlay}),l.jsxs(Q,{component:"form",...x.modal,onSubmit:$,children:[l.jsx(Z,{children:l.jsx(ee,{...x.title,children:"Velg informasjonskapsler"})}),l.jsxs(te,{children:[l.jsx("p",{children:"For at nettsidene skal fungere må vi bruke tekniske informasjonskaplser. Disse lagres derfor uten samtykke."}),h.functional&&l.jsx(T,{name:"functional",label:"Tillat funksjonelle",defaultChecked:i.functional==="accepted",children:"Funksjonelle informasjonskapsler lagrer opplysninger om din bruk av nettsidene og hvilke innstillinger du har gjort, slik at du kan få funksjonalitet tilpasset deg."},`functional-${i.functional}`),h.statistics&&l.jsx(T,{name:"statistics",label:"Tillat statistikk",defaultChecked:i.statistics==="accepted",children:"Informasjonskapslene lagrer statistikk som hjelper oss med å forstå hvordan nettsidene blir brukt, slik at vi kan gjøre dem bedre og enklere å bruke."},`statistics-${i.statistics}`),h.marketing&&l.jsx(T,{name:"marketing",label:"Tillat personlig markedsføring",defaultChecked:i.marketing==="accepted",children:"Dette gjør at vi kan gi deg mer relevant og tilpasset markedsføring, også gjennom våre samarbeidspartnere, på for eksempel nettsider, annonser og i sosiale medier."},`marketing-${i.marketing}`)]}),l.jsxs(ne,{children:[l.jsx(M,{"data-testid":"jkl-cookie-consent-godta-alle",type:"button",onClick:()=>E(),children:"Godta alle"}),l.jsx(M,{"data-testid":"jkl-cookie-consent-godta",type:"submit",children:"Godta mine valg"})]})]})]}),document.body)},Je={title:"Komponenter/CookieConsent",component:G,parameters:{layout:"centered"},tags:["autodocs"],argTypes:{}},$e=({children:e})=>{const{openConsentModal:t}=Ae();return l.jsxs("div",{children:[l.jsx(V,{onClick:()=>t(),children:"Åpne samtykker"}),e]})},R={args:{children:l.jsx($e,{children:l.jsx(De,{})}),cookieName:"demo-consent-cookie",functional:!0,statistics:!0,marketing:!0}};var L,F,K;R.parameters={...R.parameters,docs:{...(L=R.parameters)==null?void 0:L.docs,source:{originalSource:`{
  args: {
    children: <Wrapper>
                <CookieConsentComponent />
            </Wrapper>,
    cookieName: "demo-consent-cookie",
    functional: true,
    statistics: true,
    marketing: true
  }
}`,...(K=(F=R.parameters)==null?void 0:F.docs)==null?void 0:K.source}}};const Ve=["CookieConsent"];export{R as CookieConsent,Ve as __namedExportsOrder,Je as default};
