import{l as I,m as W,n as z,p as G,u as J,f as Q,b as X,a as Y,d as Z,e as ee,q as ne,r as te,i as se,j as re,t as oe,v as ae,F as ie,k as le,g as ue,o as me,h as ce,s as de}from"./getThemeAndDensity-Cbjmkdw-.js";import{c as pe}from"./clsx-B-dksMZM.js";import{r,R as s}from"./index-siqcju79.js";import{u as fe}from"./useBrowserPreferences-B9LcbCiO.js";import{S as x}from"./SlotComponent-CWN6EcE2.js";const ge=(n,e,l)=>{const[g,k]=r.useState(!1),[c,d]=r.useState(!1);return r.useEffect(()=>{if(!n)return;function a(){d(!1)}function i(u){e&&u.nodeId!==e&&u.parentId===l&&d(!1)}return n.events.on("click",a),n.events.on("menuopen",i),()=>{n.events.off("click",a),n.events.off("menuopen",i)}},[n,e,l]),r.useEffect(()=>{c&&n&&e&&n.events.emit("menuopen",{parentId:l,nodeId:e})},[n,c,e,l]),r.useEffect(()=>{function a({pointerType:u}){u!=="touch"&&k(!0)}function i(){k(!1)}return window.addEventListener("pointermove",a,{once:!0,capture:!0}),window.addEventListener("keydown",i,!0),()=>{window.removeEventListener("pointermove",a,{capture:!0}),window.removeEventListener("keydown",i,!0)}},[g]),{allowHover:g,isOpen:c,setIsOpen:d}};function O(n,e=0){switch(n){case"top":return`0 ${e}px`;case"left":return`${e}px 0`;case"bottom":return`0 ${-e}px`;case"right":return`${-e}px 0`;default:return`0 ${e}px`}}const b=r.forwardRef((n,e)=>{const{children:l,className:g,initialPlacement:k,openOnHover:c=!1,keepOpenOnClickOutside:d=!1,triggerElement:a,isOpen:i,onToggle:u,...S}=n,R=`"jkl-menu"${r.useId()}`,{prefersReducedMotion:T}=fe(),y=z(),v=G(),h=I(),p=h!=null,M=r.useRef([]),[N,P]=r.useState(null),{allowHover:F,isOpen:D,setIsOpen:C}=ge(y,v,h),f=i!==void 0?i:D;r.useEffect(()=>u?.(f),[f,u]);const{refs:E,placement:A,context:m,floatingStyles:H}=J({nodeId:v,open:f,onOpenChange:C,placement:k||(p?"right-start":"bottom-start"),middleware:[me(2),ce({fallbackAxisSideDirection:"end",crossAxis:!1}),de({padding:8})],whileElementsMounted:ue}),{getReferenceProps:L,getFloatingProps:$,getItemProps:j}=Q([X(m,{enabled:c&&F,delay:{open:75},handleClose:te({requireIntent:!0,blockPointerEvents:!0})}),Y(m,{event:"mousedown"}),Z(m,{outsidePress:!d}),ee(m,{role:"menu"}),ne(m,{listRef:M,activeIndex:N,nested:p,onNavigate:P})]),K=se([E.setReference,e]),{theme:B,density:V}=re(E.reference.current),{isMounted:_,styles:U}=oe(m,{duration:{open:T?0:250,close:T?0:150},initial:({side:t})=>({opacity:0,translate:O(t,5)}),open:({side:t})=>({opacity:1,translate:O(t,0)}),close:({side:t})=>({opacity:0,translate:O(t,5)})});return s.createElement(ae,{id:v},s.isValidElement(a)&&s.createElement(x,{...L({...S,ref:K,role:p?"menuitem":void 0,"aria-controls":R,onClick(t){t.stopPropagation()}})},a),_&&s.createElement(ie,null,s.createElement(le,{context:m,modal:!1,initialFocus:p?-1:0,returnFocus:!p},s.createElement("div",{className:pe("jkl jkl-menu",g),"data-theme":B,"data-layout-density":V,role:"menu","data-placement":A,"aria-live":"assertive","aria-hidden":!f,ref:E.setFloating,...$({id:R,style:{...H,...U}})},s.Children.map(l,(t,w)=>s.isValidElement(t)?s.createElement(x,{...j({...t.props,tabIndex:N===w?0:-1,role:"menuitem",ref(o){M.current[w]=o},onClick(o){t.props.onClick?.(o),!o.defaultPrevented&&y?.events.emit("click")},onKeyDown(o){t.props.onKeyDown?.(o),!o.defaultPrevented&&(y?.events.emit("keydown"),o.currentTarget.role==="menuitemcheckbox"&&o.key==="Enter"&&C(!1))},onMouseEnter(){F&&f&&P(w)}})},t):t)))))});b.displayName="MenuComponent";const q=r.forwardRef((n,e)=>I()===null?s.createElement(W,null,s.createElement(b,{ref:e,...n})):s.createElement(b,{ref:e,...n}));q.displayName="Menu";q.__docgenInfo={description:"",methods:[],displayName:"Menu",props:{"data-testautoid":{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},initialPlacement:{required:!1,tsType:{name:"Placement"},description:`Initiell plassering av menyen. Dersom det ikke er plass på skjermen der du
angir at den skal åpnes vil den slyttes automatisk.
@default "bottom-start" på toppnivå, "right-start" for undermenyer`},openOnHover:{required:!1,tsType:{name:"boolean"},description:`Angir om menyen skal åpnes ved hover (uten å måtte klikke)
@default false`},keepOpenOnClickOutside:{required:!1,tsType:{name:"boolean"},description:`Angir om menyen skal holdes åpen når man klikker utenfor menyen
@default false`},triggerElement:{required:!0,tsType:{name:"ReactNode"},description:'Elementet som fungerer som trigger for menyen. Dersom elementet ikke er en `<button type="button">`\neller en `forwardRef<HTMLButtonElement>` vil det bli lagt inne i en knapp\nmed forhåndsdefinert stil. For å komme raskt i gang kan du bruke komponenten\n`MenuTriggerButton` fra denne pakken.'},isOpen:{required:!1,tsType:{name:"boolean"},description:`Kan brukes til å styre utenfra om menyen skal være åpen eller ikke.
@default false`},onToggle:{required:!1,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:"Callback som kalles når menyen åpnes eller lukkes."}},composes:["Omit"]};export{q as M};
