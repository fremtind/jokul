import{j as m}from"./jsx-runtime-D9p_MChh.js";import{l as D,m as J,n as Q,p as X,u as Y,f as Z,b as ee,a as ne,d as te,e as se,q as re,r as oe,i as ae,j as ie,t as le,v as ue,F as de,k as me,g as ce,o as pe,h as fe,s as ke}from"./getThemeAndDensity-h_pKpmQq.js";import{c as ge}from"./clsx-B-dksMZM.js";import{r,R as v}from"./index-CRL2yuNo.js";import{r as q}from"./index-BpBQ4hf7.js";import{u as ye}from"./useId-BJAJhdYZ.js";import{u as ve}from"./useBrowserPreferences-pnXkstjW.js";const we=(n,e,l)=>{const[w,E]=r.useState(!1),[c,p]=r.useState(!1);return r.useEffect(()=>{if(!n)return;function s(){p(!1)}function i(o){e&&o.nodeId!==e&&o.parentId===l&&p(!1)}return n.events.on("click",s),n.events.on("menuopen",i),()=>{n.events.off("click",s),n.events.off("menuopen",i)}},[n,e,l]),r.useEffect(()=>{c&&n&&e&&n.events.emit("menuopen",{parentId:l,nodeId:e})},[n,c,e,l]),r.useEffect(()=>{function s({pointerType:o}){o!=="touch"&&E(!0)}function i(){E(!1)}return window.addEventListener("pointermove",s,{once:!0,capture:!0}),window.addEventListener("keydown",i,!0),()=>{window.removeEventListener("pointermove",s,{capture:!0}),window.removeEventListener("keydown",i,!0)}},[w]),{allowHover:w,isOpen:c,setIsOpen:p}};function b(n,e=0){switch(n){case"top":return`0 ${e}px`;case"left":return`${e}px 0`;case"bottom":return`0 ${-e}px`;case"right":return`${-e}px 0`;default:return`0 ${e}px`}}const h=r.forwardRef((n,e)=>{const{children:l,className:w,initialPlacement:E,openOnHover:c=!1,keepOpenOnClickOutside:p=!1,triggerElement:s,isOpen:i,onToggle:o,...S}=n,M=ye("jkl-menu"),{prefersReducedMotion:N}=ve(),u=Q(),x=X(),T=D(),f=T!=null,F=r.useRef([]),[P,j]=r.useState(null),{allowHover:I,isOpen:H,setIsOpen:C}=we(u,x,T),k=i!==void 0?i:H;r.useEffect(()=>o==null?void 0:o(k),[k,o]);const{refs:O,placement:L,context:d,floatingStyles:$}=Y({nodeId:x,open:k,onOpenChange:C,placement:E||(f?"right-start":"bottom-start"),middleware:[pe(2),fe({fallbackAxisSideDirection:"end",crossAxis:!1}),ke({padding:8})],whileElementsMounted:ce}),{getReferenceProps:K,getFloatingProps:B,getItemProps:V}=Z([ee(d,{enabled:c&&I,delay:{open:75},handleClose:oe({requireIntent:!0,blockPointerEvents:!0})}),ne(d,{event:"mousedown"}),te(d,{outsidePress:!p}),se(d,{role:"menu"}),re(d,{listRef:F,activeIndex:P,nested:f,onNavigate:j})]),_=ae([O.setReference,e]),{theme:U,density:W}=ie(O.reference.current),{isMounted:z,styles:G}=le(d,{duration:{open:N?0:250,close:N?0:150},initial:({side:t})=>({opacity:0,translate:b(t,5)}),open:({side:t})=>({opacity:1,translate:b(t,0)}),close:({side:t})=>({opacity:0,translate:b(t,5)})});return m.jsxs(ue,{id:x,children:[v.isValidElement(s)&&(s.type==="button"||q.isForwardRef(s))?v.cloneElement(s,{...K({...S,ref:_,role:f?"menuitem":void 0,"aria-controls":M,onClick(t){t.stopPropagation()}})}):s,z&&m.jsx(de,{children:m.jsx(me,{context:d,modal:!1,initialFocus:f?-1:0,returnFocus:!f,children:m.jsx("div",{className:ge("jkl jkl-menu",w),"data-theme":U,"data-layout-density":W,role:"menu","data-placement":L,"aria-live":"assertive","aria-hidden":!k,ref:O.setFloating,...B({id:M,style:{...$,...G}}),children:v.Children.map(l,(t,R)=>v.isValidElement(t)&&q.isForwardRef(t)?v.cloneElement(t,V({...t.props,tabIndex:P===R?0:-1,role:"menuitem",ref(a){F.current[R]=a},onClick(a){var g,y;(y=(g=t.props).onClick)==null||y.call(g,a),!a.defaultPrevented&&(u==null||u.events.emit("click"))},onKeyDown(a){var g,y;(y=(g=t.props).onKeyDown)==null||y.call(g,a),!a.defaultPrevented&&(u==null||u.events.emit("keydown"),a.currentTarget.role==="menuitemcheckbox"&&a.key==="Enter"&&C(!1))},onMouseEnter(){I&&k&&j(R)}})):t)})})})]})});h.displayName="MenuComponent";const A=r.forwardRef((n,e)=>D()===null?m.jsx(J,{children:m.jsx(h,{ref:e,...n})}):m.jsx(h,{ref:e,...n}));A.displayName="Menu";A.__docgenInfo={description:"",methods:[],displayName:"Menu",props:{"data-testautoid":{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"union",raw:"ReactNode | ReactNode[]",elements:[{name:"ReactNode"},{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},initialPlacement:{required:!1,tsType:{name:"Placement"},description:`Initiell plassering av menyen. Dersom det ikke er plass på skjermen der du
angir at den skal åpnes vil den slyttes automatisk.
@default "bottom-start" på toppnivå, "right-start" for undermenyer`},openOnHover:{required:!1,tsType:{name:"boolean"},description:`Angir om menyen skal åpnes ved hover (uten å måtte klikke)
@default false`},keepOpenOnClickOutside:{required:!1,tsType:{name:"boolean"},description:`Angir om menyen skal holdes åpen når man klikker utenfor menyen
@default false`},triggerElement:{required:!0,tsType:{name:"ReactNode"},description:'Elementet som fungerer som trigger for menyen. Dersom elementet ikke er en `<button type="button">`\neller en `forwardRef<HTMLButtonElement>` vil det bli lagt inne i en knapp\nmed forhåndsdefinert stil. For å komme raskt i gang kan du bruke komponenten\n`MenuTriggerButton` fra denne pakken.'},isOpen:{required:!1,tsType:{name:"boolean"},description:`Kan brukes til å styre utenfra om menyen skal være åpen eller ikke.
@default false`},onToggle:{required:!1,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:"Callback som kalles når menyen åpnes eller lukkes."}},composes:["Omit"]};export{A as M};
